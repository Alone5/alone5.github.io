<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Wt Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Wt Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wt Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/">





  <title>Wt Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wt Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/11/JSP-case-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/11/JSP-case-3/" itemprop="url">JSP-case-3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-11T20:18:01+08:00">
                2019-07-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/11/Servlet-Cookie-Session/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/11/Servlet-Cookie-Session/" itemprop="url">Servlet-Cookie/Session</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-11T19:28:01+08:00">
                2019-07-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Cookie、Session"><a href="#Cookie、Session" class="headerlink" title="Cookie、Session"></a>Cookie、Session</h2><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><ul>
<li><p>由于HTTP协议是无状态的协议，所以服务端需要记录用户的状态时，就需要用某种机制来识具体的用户，这个机制就是Session.典型的场景比如购物车，当你点击下单按钮时，由于HTTP协议无状态，所以并不知道是哪个用户操作的，所以服务端要为特定的用户创建了特定的Session，用用于标识这个用户，并且跟踪用户，这样才知道购物车里面有几本书。这个Session是保存在服务端的，有一个唯一标识。在服务端保存Session的方法很多，内存、数据库、文件都有。集群的时候也要考虑Session的转移，在大型的网站，一般会有专门的Session服务器集群，用来保存用户会话，这个时候 Session 信息都是放在内存的，使用一些缓存服务比如Memcached之类的来放 Session。</p>
</li>
<li><p><strong>服务端如何识别特定的客户？</strong>这个时候Cookie就登场了。每次HTTP请求的时候，客户端都会发送相应的Cookie信息到服务端。实际上大多数的应用都是用 Cookie 来实现Session跟踪的，第一次创建Session的时候，服务端会在HTTP协议中告诉客户端，需要在 Cookie 里面记录一个Session ID，以后每次请求把这个会话ID发送到服务器。客户端的浏览器禁用了 Cookie 怎么办？一般这种情况下，会使用一种URL重写的技术来进行会话跟踪，即每次HTTP交互，URL后面都会被附加上一个诸如 sid=xxxxx 这样的参数，服务端据此来识别用户。</p>
</li>
<li><p>Cookie（复数形态：Cookies），是指某些网站为了辨别用户身份、进行session跟踪而储存在用户本地终端上的数据（通常经过加密）。</p>
</li>
<li>Cookie是由服务端生成的，发送给客户端（通常是浏览器）的。Cookie总是保存在客户端中，按在客户端中的存储位置，可分为内存Cookie和硬盘Cookie：</li>
<li>内存Cookie由浏览器维护，保存在内存中，浏览器关闭后就消失了，其存在时间是短暂的。</li>
<li>硬盘Cookie保存在硬盘里，有一个过期时间，除非用户手工清理或到了过期时间，硬盘Cookie不会被删除，其存在时间是长期的。所以，按存在时间，可分为非持久Cookie和持久Cookie。</li>
<li><p>作用<br>  Cookie的根本作用就是在客户端存储用户访问网站的一些信息。典型的应用有：</p>
<ol>
<li>记住密码，下次自动登录。</li>
<li>购物车功能。</li>
<li>记录用户浏览数据，进行商品（广告）推荐。</li>
</ol>
</li>
<li><p>缺陷</p>
<ol>
<li>Cookie会被附加在每个HTTP请求中，所以无形中增加了流量。</li>
<li>由于在HTTP请求中的Cookie是明文传递的，所以安全性成问题。（除非用HTTPS）</li>
<li>Cookie的大小限制在4KB左右。对于复杂的存储需求来说是不够用的。</li>
</ol>
</li>
</ul>
<p><strong>总结一下：</strong></p>
<ul>
<li>Session是在服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中；</li>
<li>Cookie是客户端保存用户信息的一种机制，用来记录用户的一些信息，也是实现Session的一种方式</li>
</ul>
<h3 id="Cookie和Session的区别"><a href="#Cookie和Session的区别" class="headerlink" title="Cookie和Session的区别"></a>Cookie和Session的区别</h3><ol>
<li>存放位置不同<br>Cookie保存在客户端，Session保存在服务端。</li>
<li>存取方式的不同<br>Cookie中只能保管ASCII字符串，假如需求存取Unicode字符或者二进制数据，需求先进行编码。Cookie中也不能直接存取Java对象。若要存储略微复杂的信息，运用Cookie是比拟艰难的。 </li>
</ol>
<p>而Session中能够存取任何类型的数据，包括而不限于String、Integer、List、Map等。Session中也能够直接保管Java Bean乃至任何Java类，对象等，运用起来十分便当。能够把Session看做是一个Java容器类。 </p>
<ol start="3">
<li>安全性（隐私策略）的不同<br>Cookie存储在浏览器中，对客户端是可见的，客户端的一些程序可能会窥探、复制以至修正Cookie中的内容。而Session存储在服务器上，对客户端是透明的，不存在敏感信息泄露的风险。 假如选用Cookie，比较好的方法是，敏感的信息如账号密码等尽量不要写到Cookie中。最好是像Google、Baidu那样将Cookie信息加密，提交到服务器后再进行解密，保证Cookie中的信息只要本人能读得懂。而假如选择Session就省事多了，反正是放在服务器上，Session里任何隐私都能够有效的保护。 </li>
<li>有效期上的不同<br>只需要设置Cookie的过期时间属性为一个很大很大的数字，Cookie就可以在浏览器保存很长时间。 由于Session依赖于名为JSESSIONID的Cookie，而Cookie JSESSIONID的过期时间默许为–1，只需关闭了浏览器（一次会话结束），该Session就会失效。</li>
<li>对服务器造成的压力不同<br>Session是保管在服务器端的，每个用户都会产生一个Session。假如并发访问的用户十分多，会产生十分多的Session，耗费大量的内存。而Cookie保管在客户端，不占用服务器资源。假如并发阅读的用户十分多，Cookie是很好的选择。</li>
<li>跨域支持上的不同<br>Cookie支持跨域名访问，例如将domain属性设置为“.baidu.com”，则以“.baidu.com”为后缀的一切域名均能够访问该Cookie。跨域名Cookie如今被普遍用在网络中。而Session则不会支持跨域名访问。Session仅在他所在的域名内有效。 </li>
</ol>
<h3 id="HttpSession-会话机制-–-gt-Servlet的会话机制的实现"><a href="#HttpSession-会话机制-–-gt-Servlet的会话机制的实现" class="headerlink" title="HttpSession 会话机制    –&gt;Servlet的会话机制的实现"></a>HttpSession 会话机制    –&gt;Servlet的会话机制的实现</h3><p>创建于服务器端，保存于服务器，维护于服务器端,每创建一个新的Session,服务器端都会分配一个唯一的ID，并且把这个ID保存到客户端的Cookie中，保存形式是以JSESSIONID来保存的。</p>
<ul>
<li>通过HttpServletRequest.getSession 进行获得HttpSession对象，通过setAttribute()给会话赋值，可以通过invalidate()将其失效。</li>
<li>每一个HttpSession有一个唯一的标识SessionID，只要同一次打开的浏览器通过request获取到session都是同一个。浏览器不同SessionID 也不同</li>
<li>WEB容器默认的是用Cookie机制保存SessionID到客户端，并将此Cookie设置为关闭浏览器失效，Cookie名称为：JSESSIONID</li>
<li>每次请求通过读取Cookie中的SessionID获取相对应的Session会话</li>
<li>HttpSession的数据保存在服务器端，所以不要保存数据量耗资源很大的数据资源，必要时可以将属性移除或者设置为失效</li>
<li><p>HttpSession可以通过setMaxInactiveInterval()设置失效时间(秒)或者在web.xml中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--单位：分钟--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>30<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>HttpSession默认使用Cookie进行保存SessionID，当客户端禁用了Cookie之后，可以通过URL重写的方式进行实现。</p>
<ul>
<li>可以通过response.encodeURL(url)  进行实现</li>
<li>API对encodeURL的结束为，当浏览器支持Cookie时，url不做任何处理；当浏览器不支持Cookie的时候，将会重写URL将SessionID拼接到访问地址后。</li>
</ul>
</li>
</ul>
<h3 id="Cookie的使用："><a href="#Cookie的使用：" class="headerlink" title="Cookie的使用："></a>Cookie的使用：</h3><ul>
<li><p>添加Cookie：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"user"</span>, <span class="string">"suntao"</span>);</span><br><span class="line">cookie.setMaxAge(<span class="number">7</span>*<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>);     <span class="comment">// 一星期有效</span></span><br><span class="line">response.addCookie(cookie);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取Cookie</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 因为取得的是整个网页作用域的Cookie的值，所以得到的是个数组</span></span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; cookies.length ; i++)&#123;</span><br><span class="line">String name = cookies[i].getName() ;</span><br><span class="line">String value = cookies[i].getValue() ;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>cookie的存活期：默认为-1<br>会话Cookie：把Cookie保存到浏览器上，当存活期为负数<br>持久Cookie：把Cookie保存到文件中，当存活期为正数<br>设置存活期：c.setMaxAge();</p>
</blockquote>
<p><strong>Cookie中的特殊字符和中文</strong><br>由于Cookie是在Http协议头部传送的， Http协议头必须是 ISO8859-1 编码，并且不能使用特殊字符和中文。</p>
<ul>
<li>利用 Escape 编码进行解决，是HTTP协议标准。</li>
<li>数据加入Cookie之前进行编码即可。</li>
<li>Java 提供了编码API<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URLEncoder.encode(&quot;您好Cookie&quot;, &quot;UTF-8&quot;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>利用Java Servlet API 下发Cookie</p>
<ul>
<li>下发Cookie，response 对象上有下发Cookies API：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AddCookieServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  请求路径 /add-cookie</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 利用response下发一个Cookie到浏览器</span></span><br><span class="line">        <span class="comment">//1. 创建一个Cookie</span></span><br><span class="line">        Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"message"</span>, URLEncoder.encode(<span class="string">"Hello World!"</span>,<span class="string">"UTF-8"</span>));</span><br><span class="line">        Cookie cookie2 = <span class="keyword">new</span> Cookie(<span class="string">"test"</span>, URLEncoder.encode(<span class="string">"您好Cookie"</span>, <span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. 下发Cookie</span></span><br><span class="line">        response.addCookie(cookie);</span><br><span class="line">        response.addCookie(cookie2);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=UTF-8"</span>);</span><br><span class="line">        response.getWriter().print(<span class="string">"OK"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="什么时候需要使用Session"><a href="#什么时候需要使用Session" class="headerlink" title="什么时候需要使用Session"></a>什么时候需要使用Session</h3><p>通常，使用Session存储：</p>
<ol>
<li>用户的身份的唯一标识，例如：用户的id；</li>
<li>使用频率较高的数据，例如：用户名；</li>
<li>不便于使用其它解决方案去存储或者传递的数据。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/10/JSP-Java-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/10/JSP-Java-2/" itemprop="url">JSP-Java-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-10T20:52:58+08:00">
                2019-07-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="标准标签库-和-EL表达式"><a href="#标准标签库-和-EL表达式" class="headerlink" title="标准标签库 和 EL表达式"></a>标准标签库 和 EL表达式</h2><p>关于标签库 和 EL表达式：</p>
<ol>
<li>网页中的Java代码不方便维护，经常出现 空指针异常，不友好。</li>
<li>SUN提供了自定义标签技术，用于替代Java代码。每个厂商都设计了自己标签。 标签无法通用。自定义标签语法复杂，实现繁琐成本高。</li>
<li>Apache组织设计了“标准标签库 JSTL” 实现了绝大部分企业需要用的标签功能。 目前企业基本上都使用标准标签库解决问题。</li>
</ol>
<blockquote>
<p>使用标准标签库 和 EL表达式</p>
</blockquote>
<h3 id="EL-表达式"><a href="#EL-表达式" class="headerlink" title="EL 表达式"></a>EL 表达式</h3><p>EL 表达式有标准标签库一起诞生， 与JSTL配合使用</p>
<ol>
<li>自动化工作：可以在pageContext，request，session，application中子弹寻找 “attribute”</li>
<li>自动调用 get方法</li>
<li>自动处理空值</li>
</ol>
<p>HelloWorld:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">  <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span>  </span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  <span class="comment">//代表在Servlet中向 request 对象添加的数据</span></span><br><span class="line">  request.setAttribute(<span class="string">"message"</span>, <span class="string">"Hello World!"</span>);</span><br><span class="line">  Emp emp = <span class="keyword">new</span> Emp(<span class="number">1</span>, <span class="string">"Tom"</span>, <span class="number">1</span>, <span class="keyword">null</span>, <span class="number">1</span>, <span class="number">1000</span>,<span class="number">100</span>); </span><br><span class="line">  request.setAttribute(<span class="string">"emp"</span>, emp);</span><br><span class="line">  request.setAttribute(<span class="string">"text"</span>, <span class="keyword">null</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;EL EL表达式演示&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h1&gt;EL表达式演示&lt;/h1&gt;</span><br><span class="line">  &lt;h2&gt;Java 代码输出数据&lt;/h2&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  <span class="comment">//定义变量，利用getAttribute寻获数据</span></span><br><span class="line">  String message = </span><br><span class="line">    (String)request.getAttribute(<span class="string">"message"</span>);</span><br><span class="line">  Emp one = (Emp) request.getAttribute(<span class="string">"emp"</span>);</span><br><span class="line">  String text=(String)request.getAttribute(<span class="string">"text"</span>);</span><br><span class="line">%&gt;  </span><br><span class="line">  &lt;p&gt;利用java表达式输出数据： &lt;%=message%&gt; </span><br><span class="line">      &lt;%=one.getEname()%&gt; &lt;%=text%&gt; &lt;/p&gt;</span><br><span class="line"></span><br><span class="line">  &lt;h2&gt;EL表达式输出信息&lt;/h2&gt;</span><br><span class="line">  &lt;p&gt;自动寻获 $&#123;message&#125;，</span><br><span class="line">          自动调用get方法 $&#123;emp.ename&#125; </span><br><span class="line">          自动处理空 $&#123;text&#125; &lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="EL-语法"><a href="#EL-语法" class="headerlink" title="EL 语法"></a>EL 语法</h4><p>好处是： 简洁!  写的少，做的多</p>
<ol>
<li><p>可以访问对象的 getXxx() 方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.name  就是访问了 obj.getName()</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以访问数组、List集合的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[下标]  </span><br><span class="line">list[下标]</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以访问map</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map.key 得到 value</span><br><span class="line">map[&apos;key&apos;] 得到value</span><br></pre></td></tr></table></figure>
</li>
<li><p>以上方式的符合使用，无需类型转换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list[1].ename </span><br><span class="line">map.east.ename</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>案例：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">  <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span>  </span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  <span class="keyword">int</span>[] arr1 = &#123;<span class="number">5</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">  String[] arr2 = &#123;<span class="string">"Tom"</span>,<span class="string">"Jerry"</span>&#125;;</span><br><span class="line">  Emp[] arr3 = &#123;<span class="keyword">new</span> Emp(<span class="number">1</span>, <span class="string">"光头强"</span>, <span class="number">1</span>, <span class="keyword">null</span>, <span class="number">1</span>,<span class="number">100</span>,<span class="number">10</span>),</span><br><span class="line">          <span class="keyword">new</span> Emp(<span class="number">1</span>,<span class="string">"李大嘴"</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">100</span>,<span class="number">10</span>)&#125;;</span><br><span class="line">  List&lt;String&gt; list1 = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">  list1.add(<span class="string">"沉鱼落雁"</span>);</span><br><span class="line">  list1.add(<span class="string">"明眸善睐"</span>);</span><br><span class="line">  List&lt;Emp&gt; list2 = <span class="keyword">new</span> ArrayList&lt;Emp&gt;();</span><br><span class="line">  list2.add(<span class="keyword">new</span> Emp(<span class="number">3</span>,<span class="string">"擎天柱"</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">1</span>));</span><br><span class="line">  list2.add(<span class="keyword">new</span> Emp(<span class="number">4</span>,<span class="string">"大黄蜂"</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">20</span>,<span class="number">5</span>));</span><br><span class="line">  Map&lt;String, Emp&gt; map=<span class="keyword">new</span> HashMap&lt;String, Emp&gt;();</span><br><span class="line">  map.put(<span class="string">"east"</span>, <span class="keyword">new</span> Emp(<span class="number">6</span>,<span class="string">"黄老邪"</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">50</span>,<span class="number">1</span>));</span><br><span class="line">  map.put(<span class="string">"north"</span>, <span class="keyword">new</span> Emp(<span class="number">7</span>,<span class="string">"洪七公"</span>,<span class="number">1</span>,<span class="keyword">null</span>,<span class="number">1</span>,<span class="number">40</span>,<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">  request.setAttribute(<span class="string">"arr1"</span>, arr1);</span><br><span class="line">  request.setAttribute(<span class="string">"arr2"</span>, arr2);</span><br><span class="line">  request.setAttribute(<span class="string">"arr3"</span>, arr3);</span><br><span class="line">  request.setAttribute(<span class="string">"list1"</span>, list1);</span><br><span class="line">  request.setAttribute(<span class="string">"list2"</span>, list2);</span><br><span class="line">  request.setAttribute(<span class="string">"map"</span>, map);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;EL EL表达式演示2&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h1&gt;EL表达式演示2&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;arr1: $&#123;arr1[0]&#125; $&#123;arr1[1]&#125; &lt;/p&gt;</span><br><span class="line">  &lt;p&gt;arr2: $&#123;arr2[0]&#125; $&#123;arr2[1]&#125; &lt;/p&gt;</span><br><span class="line">  &lt;p&gt;arr3: $&#123;arr3[0].ename&#125; $&#123;arr3[0].empno&#125;&lt;/p&gt; </span><br><span class="line">  &lt;p&gt;list1: $&#123;list1[0]&#125;&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;list2: $&#123;list2[0].ename&#125;&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;map: $&#123;map.east.ename&#125; $&#123;map['east'].ename&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="JSTL"><a href="#JSTL" class="headerlink" title="JSTL"></a>JSTL</h3><p>使用步骤:</p>
<ol>
<li><p>导包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在JSP 导入标签库</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span> %&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用JSP标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:out value=&quot;$&#123;message&#125;&quot;&gt;&lt;/c:out&gt;</span><br><span class="line">out 标签用于输出信息, 自动替换特殊符合，相对输出安全</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>HelloWorld案例：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">  <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span>  </span><br><span class="line">%&gt;</span><br><span class="line">&lt;!-- 导入 core 核心标签库，使用前缀是c --&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">  request.setAttribute(<span class="string">"message"</span>, <span class="string">"&lt;Hello World!&gt;"</span>); </span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;JSTL 演示&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h1&gt;JSTL演示&lt;/h1&gt; </span><br><span class="line">  &lt;!-- out 将信息输出到网页中 --&gt;</span><br><span class="line">  &lt;p&gt;&lt;c:out value="$&#123;message&#125;"&gt;&lt;/c:out&gt;&lt;/p&gt;</span><br><span class="line">  &lt;p&gt;$&#123;message&#125;&lt;/p&gt;</span><br><span class="line">  &lt;!-- JSTL 标签和 EL 表达式都是在服务器上处理的 --&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="JSTL-有哪些常用标签："><a href="#JSTL-有哪些常用标签：" class="headerlink" title="JSTL 有哪些常用标签："></a>JSTL 有哪些常用标签：</h4><p>JSTL标签的设计目的：用于取代浏览器的中的用于显示信息的Java代码</p>
<ol>
<li>out标签，用于输出数据，相对于EL表达式输出，out标签进行了特殊字符替换</li>
<li><p>for 循环标签： 1 计次循环， 2 集合遍历</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach begin=<span class="string">"1"</span> end=<span class="string">"5"</span> step=<span class="string">"2"</span> <span class="keyword">var</span>=<span class="string">"i"</span>&gt; </span><br><span class="line">  &lt;p&gt;$&#123;i&#125;&lt;/p&gt;</span><br><span class="line">&lt;/c:forEach&gt; </span><br><span class="line">&lt;ul&gt;</span><br><span class="line">  &lt;c:forEach items=<span class="string">"$&#123;list&#125;"</span> <span class="keyword">var</span>=<span class="string">"emp"</span> &gt; </span><br><span class="line">    &lt;li&gt;$&#123;emp.empno&#125;, $&#123;emp.ename&#125;&lt;/li&gt; </span><br><span class="line">  &lt;/c:forEach&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>if标签 单路分支标签</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;active&gt;=100&#125;"</span>&gt;</span><br><span class="line">   &lt;span style="color:red"&gt;赚钱了&lt;/span&gt;</span><br><span class="line">&lt;/c:if&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多路分支标签</p>
</li>
</ol>
<ul>
<li>choose</li>
<li>when</li>
<li>otherwise</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:choose&gt;</span><br><span class="line">  &lt;c:when test=<span class="string">"$&#123;active&gt;=200&#125;"</span>&gt;</span><br><span class="line">    &lt;span style="color:red"&gt;赚大了&lt;/span&gt;</span><br><span class="line">  &lt;/c:when&gt;</span><br><span class="line">  &lt;c:when test=<span class="string">"$&#123;active&gt;=100&#125;"</span>&gt;</span><br><span class="line">    &lt;span style="color:red"&gt;赚钱了&lt;/span&gt;  </span><br><span class="line">  &lt;/c:when&gt;</span><br><span class="line">  &lt;c:otherwise&gt;</span><br><span class="line">    &lt;span style="color:green"&gt;赔本了&lt;/span&gt;</span><br><span class="line">  &lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>import 包含标<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:import url="footer.jsp"&gt;&lt;/c:import&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>重要：JSP、JSP中的脚本、JSP中的指令（包含）、EL、JSTL、等都是在服务器端执行的。 执行结束以后将生成HTML发送到浏览器显示结果。</p>
</blockquote>
<p>案例:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">  <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span>  </span><br><span class="line">%&gt;</span><br><span class="line">&lt;!-- 导入 core 核心标签库，使用前缀是c --&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;JSTL 演示&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h1&gt;JSTL演示&lt;/h1&gt; </span><br><span class="line">  &lt;h2&gt;forEach 标签&lt;/h2&gt;</span><br><span class="line">  &lt;!-- begin: 开始， end：结束 step: 步子 <span class="keyword">var</span>:变量名</span><br><span class="line">   如下案例：从<span class="number">1</span>开始循环， 每次增加<span class="number">2</span>， 到<span class="number">5</span>结束循环--&gt;</span><br><span class="line">  &lt;c:forEach begin=<span class="string">"1"</span> end=<span class="string">"5"</span> step=<span class="string">"2"</span> <span class="keyword">var</span>=<span class="string">"i"</span>&gt; </span><br><span class="line">    &lt;p&gt;$&#123;i&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/c:forEach&gt;</span><br><span class="line">  &lt;h2&gt;集合的遍历&lt;/h2&gt;</span><br><span class="line">  &lt;%</span><br><span class="line">    <span class="comment">//在实际开发中，如下数据应该在Servlet中生成</span></span><br><span class="line">    List&lt;String&gt; names = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    names.add(<span class="string">"佟湘玉"</span>);</span><br><span class="line">    names.add(<span class="string">"白展堂"</span>);</span><br><span class="line">    names.add(<span class="string">"莫小贝"</span>);</span><br><span class="line">    names.add(<span class="string">"李大嘴"</span>);</span><br><span class="line">    request.setAttribute(<span class="string">"names"</span>, names); </span><br><span class="line"></span><br><span class="line">    List&lt;Emp&gt; list=<span class="keyword">new</span> ArrayList&lt;Emp&gt;();</span><br><span class="line">    list.add(<span class="keyword">new</span> Emp(<span class="number">1</span>, <span class="string">"霸波奔"</span>, <span class="number">1</span>, <span class="keyword">null</span>, <span class="number">1</span>, <span class="number">100</span>,<span class="number">10</span>));</span><br><span class="line">    list.add(<span class="keyword">new</span> Emp(<span class="number">2</span>, <span class="string">"奔波霸"</span>, <span class="number">1</span>, <span class="keyword">null</span>, <span class="number">1</span>, <span class="number">200</span>,<span class="number">10</span>));</span><br><span class="line">    request.setAttribute(<span class="string">"list"</span>, list); </span><br><span class="line">  %&gt;  </span><br><span class="line">  &lt;!-- forEach 遍历集合 --&gt;</span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;names&#125;"</span> <span class="keyword">var</span>=<span class="string">"name"</span>&gt; </span><br><span class="line">      &lt;li&gt;$&#123;name&#125;&lt;/li&gt;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">  &lt;h2&gt;遍历对象集合&lt;/h2&gt;</span><br><span class="line">  &lt;ul&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">"$&#123;list&#125;"</span> <span class="keyword">var</span>=<span class="string">"emp"</span> &gt; </span><br><span class="line">      &lt;li&gt;$&#123;emp.empno&#125;, $&#123;emp.ename&#125;&lt;/li&gt; </span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">  &lt;/ul&gt;</span><br><span class="line">  &lt;h2&gt;if 标签&lt;/h2&gt;</span><br><span class="line">  &lt;!-- <span class="keyword">if</span> 标签只能实现单路分支 --&gt;</span><br><span class="line">  &lt;%</span><br><span class="line">    request.setAttribute(<span class="string">"active"</span>, <span class="number">100</span>);</span><br><span class="line">  %&gt;</span><br><span class="line">  &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;active&gt;=100&#125;"</span>&gt;</span><br><span class="line">     &lt;span style="color:red"&gt;赚钱了&lt;/span&gt;</span><br><span class="line">  &lt;/c:if&gt;</span><br><span class="line">  &lt;h2&gt;多路分支标签&lt;/h2&gt;</span><br><span class="line">  &lt;!-- 多路分支包含其他情形，相当于<span class="keyword">else</span> </span><br><span class="line">    choose 选择 when:当，当xxx的时候，otherwise其他情况 --&gt;</span><br><span class="line">  &lt;c:choose&gt;</span><br><span class="line">    &lt;c:when test=<span class="string">"$&#123;active&gt;=200&#125;"</span>&gt;</span><br><span class="line">      &lt;span style="color:red"&gt;赚大了&lt;/span&gt;</span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test=<span class="string">"$&#123;active&gt;=100&#125;"</span>&gt;</span><br><span class="line">      &lt;span style="color:red"&gt;赚钱了&lt;/span&gt;  </span><br><span class="line">    &lt;/c:when&gt;</span><br><span class="line">    &lt;c:otherwise&gt;</span><br><span class="line">      &lt;span style="color:green"&gt;赔本了&lt;/span&gt;</span><br><span class="line">    &lt;/c:otherwise&gt;</span><br><span class="line">  &lt;/c:choose&gt;</span><br><span class="line">  &lt;h2&gt;包含标签&lt;/h2&gt;</span><br><span class="line">  &lt;!-- 其功能与  jsp:include  一样 --&gt;</span><br><span class="line">  &lt;c:import url="footer.jsp"&gt;&lt;/c:import&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="利用JSTL和EL重构-list-emp2-jsp"><a href="#利用JSTL和EL重构-list-emp2-jsp" class="headerlink" title="利用JSTL和EL重构 list-emp2.jsp:"></a>利用JSTL和EL重构 list-emp2.jsp:</h2><ol>
<li><p>导入标签库：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">"c"</span> uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新头部组件包含</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Header 包含子页面  --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/header.jsp"</span>/&gt;</span><br><span class="line">   </span><br><span class="line">&lt;!-- Left side 包含子页面 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/left-side.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新集合遍历输出表格</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach items=<span class="string">"$&#123;list&#125;"</span> <span class="keyword">var</span>=<span class="string">"emp"</span>&gt;             </span><br><span class="line">&lt;tr&gt;</span><br><span class="line">  &lt;td&gt;$&#123;emp.empno&#125;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;c:out value="$&#123;emp.ename&#125;"/&gt;&lt;/td&gt; </span><br><span class="line">  &lt;td&gt;$&#123;emp.mgr&#125;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;$&#123;emp.hiredate&#125;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;$&#123;emp.deptno&#125;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;$&#123;emp.salary&#125;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;$&#123;emp.comm&#125;&lt;/td&gt;</span><br><span class="line">  &lt;!-- onclick中出现<span class="string">"return false"</span> 则会阻止事件</span><br><span class="line">  -点击事件的响应 --&gt;</span><br><span class="line">  &lt;td&gt;&lt;a onclick=<span class="string">"return confirm('真的删除?吗?')"</span> </span><br><span class="line">    href=<span class="string">"delete?empno=$&#123;emp.empno&#125;"</span> </span><br><span class="line">    <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-danger btn-xs"</span></span><br><span class="line">    &gt;&lt;i class="fa fa-fw fa-remove"&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">    &lt;a href=<span class="string">"edit-emp?empno=$&#123;emp.empno&#125;"</span></span><br><span class="line">      <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-success btn-xs"</span>&gt;&lt;i </span><br><span class="line">      class="fa fa-fw fa-edit"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新尾部组件包含</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Footer 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/footer.jsp"</span>/&gt;</span><br><span class="line">   </span><br><span class="line">&lt;!-- Control Sidebar 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/sidebar.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="利用JSTL和EL重构-add-emp-jsp"><a href="#利用JSTL和EL重构-add-emp-jsp" class="headerlink" title="利用JSTL和EL重构 add-emp.jsp:"></a>利用JSTL和EL重构 add-emp.jsp:</h2><ol>
<li><p>导入JSTL</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换头部包含标签</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Header 包含子页面  --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/header.jsp"</span>/&gt;</span><br><span class="line">&lt;!-- Left side 包含子页面 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/left-side.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换Java代码</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;select <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"mgr"</span> name=<span class="string">"mgr"</span>&gt;</span><br><span class="line">  &lt;c:forEach items=<span class="string">"$&#123;mgrs&#125;"</span> <span class="keyword">var</span>=<span class="string">"mgr"</span>&gt;</span><br><span class="line">    &lt;!-- 客户端选中员工名，发送到服务器是对应的员工号</span><br><span class="line">     value属性是发送到服务器上的值 --&gt;</span><br><span class="line">    &lt;option value=<span class="string">"$&#123;mgr.empno&#125;"</span>&gt;</span><br><span class="line">      &lt;c:out value=<span class="string">"$&#123;mgr.ename&#125;"</span>/&gt;</span><br><span class="line">    &lt;/option&gt;</span><br><span class="line">  &lt;/c:forEach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换尾部包含</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Footer 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/footer.jsp"</span>/&gt;</span><br><span class="line">&lt;!-- Control Sidebar 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/sidebar.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="利用JSTL和EL重构-edit-emp-jsp"><a href="#利用JSTL和EL重构-edit-emp-jsp" class="headerlink" title="利用JSTL和EL重构 edit-emp.jsp:"></a>利用JSTL和EL重构 edit-emp.jsp:</h2><ol>
<li><p>导入JSTL</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="string">"c"</span>%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换头部包含标签</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Header 包含子页面  --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/header.jsp"</span>/&gt;</span><br><span class="line">&lt;!-- Left side 包含子页面 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/left-side.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换Java代码</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Horizontal Form --&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box box-info"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-header with-border"</span>&gt;</span><br><span class="line">    &lt;h3 class="box-title"&gt;添加新员工信息&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- /.box-header --&gt;</span><br><span class="line">  &lt;!-- form start --&gt;</span><br><span class="line">  &lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-horizontal"</span> </span><br><span class="line">    method=<span class="string">"post"</span> action=<span class="string">"update-emp"</span>&gt; </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-body"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"empno"</span> </span><br><span class="line">          class="col-sm-2 control-label"&gt;员工号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">            id=<span class="string">"empno"</span> name=<span class="string">"empno"</span> placeholder=<span class="string">"员工号"</span></span><br><span class="line">            value=<span class="string">"$&#123;emp.empno&#125;"</span></span><br><span class="line">            readonly=<span class="string">"readonly"</span> &gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"ename"</span> </span><br><span class="line">          class="col-sm-2 control-label"&gt;姓名&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">            id=<span class="string">"ename"</span> name=<span class="string">"ename"</span> placeholder=<span class="string">"姓名"</span></span><br><span class="line">            value=<span class="string">"&lt;c:out value="</span>$&#123;emp.ename&#125;<span class="string">"/&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"mgr"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;领导&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">   </span><br><span class="line">          &lt;select <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"mgr"</span> name=<span class="string">"mgr"</span>&gt;</span><br><span class="line">            &lt;c:forEach items=<span class="string">"$&#123;mgrs&#125;"</span> <span class="keyword">var</span>=<span class="string">"mgr"</span>&gt;</span><br><span class="line">            &lt;!-- 客户端选中员工名，发送到服务器是对应的员工号</span><br><span class="line">             value属性是发送到服务器上的值 --&gt;</span><br><span class="line">              &lt;c:choose&gt;</span><br><span class="line">                &lt;c:when test=<span class="string">"$&#123;emp.mgr == mgr.empno&#125;"</span>&gt;</span><br><span class="line">                  &lt;option value=<span class="string">"$&#123;mgr.empno&#125;"</span></span><br><span class="line">                    selected=<span class="string">"selected"</span>&gt;</span><br><span class="line">                    &lt;c:out value=<span class="string">"$&#123;mgr.ename&#125;"</span>/&gt;</span><br><span class="line">                  &lt;/option&gt;  </span><br><span class="line">                &lt;/c:when&gt;</span><br><span class="line">                &lt;c:otherwise&gt;</span><br><span class="line">                  &lt;option value=<span class="string">"$&#123;mgr.empno&#125;"</span>&gt;</span><br><span class="line">                    &lt;c:out value=<span class="string">"$&#123;mgr.ename&#125;"</span>/&gt;</span><br><span class="line">                  &lt;/option&gt;        </span><br><span class="line">                &lt;/c:otherwise&gt;</span><br><span class="line">              &lt;/c:choose&gt; </span><br><span class="line">            &lt;/c:forEach&gt;</span><br><span class="line">          &lt;/select&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"hiredate"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;入职日期&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"date"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"hiredate"</span> name=<span class="string">"hiredate"</span>  </span><br><span class="line">          placeholder=<span class="string">"入职日期"</span> </span><br><span class="line">          value=<span class="string">"$&#123;emp.hiredate&#125;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"deptno"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;部门编号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"deptno"</span> name=<span class="string">"deptno"</span>  </span><br><span class="line">          placeholder=<span class="string">"部门编号"</span></span><br><span class="line">          value=<span class="string">"$&#123;emp.deptno&#125;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"salary"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;薪资&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"salary"</span> name=<span class="string">"salary"</span>  </span><br><span class="line">          placeholder=<span class="string">"薪资"</span></span><br><span class="line">          value=<span class="string">"$&#123;emp.salary&#125;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"comm"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;提成&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"comm"</span> name=<span class="string">"comm"</span>  </span><br><span class="line">          placeholder=<span class="string">"提成"</span></span><br><span class="line">          value=<span class="string">"$&#123;emp.comm&#125;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;                                </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-body --&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-footer"</span>&gt;</span><br><span class="line">      &lt;button type="submit" class="btn btn-info pull-right"&gt;保存&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-footer --&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- /.box --&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换尾部包含</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Main Footer 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/footer.jsp"</span>/&gt;</span><br><span class="line">&lt;!-- Control Sidebar 包含 --&gt;</span><br><span class="line">&lt;c:<span class="keyword">import</span> url=<span class="string">"/WEB-INF/include/sidebar.jsp"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="显示老板名字问题"><a href="#显示老板名字问题" class="headerlink" title="显示老板名字问题"></a>显示老板名字问题</h2><ol>
<li><p>重构 ListEmpServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建集合，缓存全部的员工号和员工名</span></span><br><span class="line">Map&lt;Integer, String&gt; names = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">    names.put(emp.getEmpno(), emp.getEname());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打桩测试 ...</span></span><br><span class="line">request.setAttribute(<span class="string">"names"</span>, names);</span><br></pre></td></tr></table></figure>
</li>
<li><p>重构 list-emp2.jsp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;c:out value=&quot;$&#123;names[emp.mgr]&#125;&quot;/&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<h2 id="路径问题"><a href="#路径问题" class="headerlink" title="路径问题"></a>路径问题</h2><p>Web编程时候有3套路径体系</p>
<ol>
<li>浏览器视角的Web路径</li>
<li>Java Web 用于程序的路径体系</li>
<li>本地操作系统文件路径体系<ul>
<li>ContextPath路径： Java web应用程序部署在Web服务器时候的部署文件夹。</li>
<li>浏览器视角的路径与Java WEB路径相差了一个ContextPath路径</li>
</ul>
</li>
</ol>
<ul>
<li>将Java Web路径映射到浏览器视角的Web路径有多种解决方案：</li>
</ul>
<ol>
<li>使用相对路径<ul>
<li>书写简单，当页面移动显示位置时候会css等资源加载失败出现404错误</li>
</ul>
</li>
<li>利用 &lt;c:url&gt; 标签解决<ul>
<li>&lt;c:url&gt; 标签就是解决将Java WEB路径转化为 浏览器视角绝对路径而设计的标签</li>
<li>这个标签使用比较繁琐</li>
</ul>
</li>
<li>利用EL表达式在路径前面添加ContextPath，这种方式简洁方便。<ul>
<li>在Servlet中将 contextPath保存到request中叫 root</li>
<li>在页面中将所有 html 标签路径修改为 ${root}/…</li>
</ul>
</li>
</ol>
<p>案例, 将全部emp功能移动到 /emp 中, 目的是为了后续增加权限管理功能</p>
<pre><code>- 更新全部功能的URL
</code></pre><p>修改 员工列表功能：</p>
<ol>
<li><p>修改web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day05.ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/emp/list<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>此时查看网页/emp/list会看到很多 404 错误，导致很多css、js文件没有加载，因为路径上增加了一层emp造成了浏览器视角路径错误，找不到对应资源了。</p>
</blockquote>
</li>
<li><p>更新 ListEmpServlet, 将contextPath添加到request中，命名为root</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将context路径保存request中， 用于将</span></span><br><span class="line"><span class="comment">//Java WEB目录映射到 浏览器视角WEB目录</span></span><br><span class="line">String contextPath = request.getContextPath();</span><br><span class="line">request.setAttribute(<span class="string">"root"</span>, contextPath);</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新 list-emp2.jsp 将全部html标签中的路径更新为 ${root}/</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"$&#123;root&#125;/bower_components/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"$&#123;root&#125;/bower_components/font-awesome/css/font-awesome.min.css"</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"$&#123;root&#125;/bower_components/Ionicons/css/ionicons.min.css"</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"$&#123;root&#125;/dist/css/AdminLTE.min.css"</span>&gt;</span><br><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"$&#123;root&#125;/dist/css/skins/skin-blue.min.css"</span>&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;!-- jQuery <span class="number">3</span> --&gt;</span><br><span class="line">&lt;script src="$&#123;root&#125;/bower_components/jquery/dist/jquery.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- Bootstrap <span class="number">3.3</span>.7 --&gt;</span><br><span class="line">&lt;script src="$&#123;root&#125;/bower_components/bootstrap/dist/js/bootstrap.min.js"&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- AdminLTE App --&gt;</span><br><span class="line">&lt;script src="$&#123;root&#125;/dist/js/adminlte.min.js"&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新 header.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">"$&#123;root&#125;/dist/img/user2-160x160.jpg"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"img-circle"</span> alt=<span class="string">"User Image"</span>&gt;</span><br><span class="line">   ...</span><br><span class="line">&lt;img src=<span class="string">"$&#123;root&#125;/dist/img/user2-160x160.jpg"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"user-image"</span> alt=<span class="string">"User Image"</span>&gt;</span><br><span class="line">   ...</span><br><span class="line">&lt;img src=<span class="string">"$&#123;root&#125;/dist/img/user2-160x160.jpg"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"img-circle"</span> alt=<span class="string">"User Image"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新 left-side.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">"$&#123;root&#125;/dist/img/user2-160x160.jpg"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"img-circle"</span> alt=<span class="string">"User Image"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试 /emp/list</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/10/JSP-case-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/10/JSP-case-2/" itemprop="url">JSP-case-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-10T20:41:10+08:00">
                2019-07-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实现“领导”列表"><a href="#实现“领导”列表" class="headerlink" title="实现“领导”列表"></a>实现“领导”列表</h2><p>更新添加界面，实现“领导”列表。<br>步骤:</p>
<ol>
<li><p>更新 EmpDao 添加方法查询所有的领导：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取员工中的全部领导</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title">findMgrs</span><span class="params">()</span></span>&#123;</span><br><span class="line">    String sql = <span class="string">"select empno, ename, mgr, hiredate, deptno, salary, comm from t_emp where mgr=0 or mgr=1"</span>;</span><br><span class="line">    <span class="keyword">try</span>(Connection conn=DBUtil.getConnection())&#123;</span><br><span class="line">        Statement st = conn.createStatement();</span><br><span class="line">        ResultSet rs = st.executeQuery(sql);</span><br><span class="line">        List&lt;Emp&gt; list=<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">            <span class="comment">//必须是没有编译错误，并且选定的代码块能够抽取为方法！</span></span><br><span class="line">            Emp emp = row2Emp(rs);</span><br><span class="line">            list.add(emp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Emp <span class="title">row2Emp</span><span class="params">(ResultSet rs)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> empno = rs.getInt(<span class="string">"empno"</span>);</span><br><span class="line">    String ename = rs.getString(<span class="string">"ename"</span>);</span><br><span class="line">    <span class="keyword">int</span> mgr = rs.getInt(<span class="string">"mgr"</span>);</span><br><span class="line">    Date hiredate=rs.getDate(<span class="string">"hiredate"</span>);</span><br><span class="line">    <span class="keyword">int</span> deptno = rs.getInt(<span class="string">"deptno"</span>);</span><br><span class="line">    <span class="keyword">double</span> salary = rs.getDouble(<span class="string">"salary"</span>);</span><br><span class="line">    <span class="keyword">double</span> comm = rs.getDouble(<span class="string">"comm"</span>);</span><br><span class="line">    Emp emp = <span class="keyword">new</span> Emp(empno, ename, mgr, hiredate, deptno, salary, comm);</span><br><span class="line">    <span class="keyword">return</span> emp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindMgrs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">    List&lt;Emp&gt; list = dao.findMgrs();</span><br><span class="line">    <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">        System.out.println(emp); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 AddEmpServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AddEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * URL /add-emp</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">           EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">           List&lt;Emp&gt; mgrs = dao.findMgrs();</span><br><span class="line">           request.setAttribute(<span class="string">"mgrs"</span>, mgrs);</span><br><span class="line">           request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/add-emp.jsp"</span>)</span><br><span class="line">.forward(request, response);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>AddEmpServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>AddEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day07.AddEmpServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>AddEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/add-emp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将 add-emp.jsp 移动到 /WEB-INF/jsp/add-emp.jsp 并且更新：</p>
</li>
<li><p>在 add-emp.jsp 添加导入</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span></span><br><span class="line"></span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">  &lt;label <span class="keyword">for</span>=<span class="string">"mgr"</span> </span><br><span class="line">  class="col-sm-2 control-label"&gt;领导&lt;/label&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">      List&lt;Emp&gt; mgrs=(List&lt;Emp&gt;)request.getAttribute(<span class="string">"mgrs"</span>);</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;select <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"mgr"</span> name=<span class="string">"mgr"</span>&gt;</span><br><span class="line">      &lt;%<span class="keyword">for</span>(Emp mgr:mgrs)&#123;%&gt;</span><br><span class="line">      &lt;!-- 客户端选中员工名，发送到服务器是对应的员工号</span><br><span class="line">       value属性是发送到服务器上的值 --&gt;</span><br><span class="line">      &lt;option value=<span class="string">"&lt;%=mgr.getEmpno()%&gt;"</span>&gt;</span><br><span class="line">        &lt;%=mgr.getEname()%&gt;</span><br><span class="line">      &lt;/option&gt;</span><br><span class="line">      &lt;%&#125;%&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重构 list-emp2.jsp</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"box-title"</span>&gt;</span>员工信息 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"add-emp"</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span>&gt;</span>添加<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<h2 id="实现修改员工信息功能"><a href="#实现修改员工信息功能" class="headerlink" title="实现修改员工信息功能"></a>实现修改员工信息功能</h2><p>实现步骤：</p>
<ol>
<li><p>EmpDao中添加查找和更新的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据ID获取一个员工信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Emp <span class="title">findByEmpno</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">"select empno, ename, mgr, hiredate, deptno, salary, comm from t_emp where empno=?"</span>;</span><br><span class="line">    <span class="keyword">try</span>(Connection conn = DBUtil.getConnection())&#123;</span><br><span class="line">        PreparedStatement ps=conn.prepareStatement(sql);</span><br><span class="line">        ps.setInt(<span class="number">1</span>, empno);</span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        Emp emp=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">            emp = row2Emp(rs); <span class="comment">//重用 row2Emp 方法</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> emp; <span class="comment">//找到结果返回emp对象，</span></span><br><span class="line">        <span class="comment">//找不到返回null表示"空"结果。</span></span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据ID更新员工信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateEmp</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">    String sql = <span class="string">"update t_emp set ename=?, mgr=?, hiredate=?, deptno=?,salary=?, comm=? where empno=?"</span>;</span><br><span class="line">    <span class="keyword">try</span>(Connection conn = DBUtil.getConnection())&#123;</span><br><span class="line">        PreparedStatement ps=conn.prepareStatement(sql);</span><br><span class="line">        ps.setString(<span class="number">1</span>, emp.getEname());</span><br><span class="line">        ps.setInt(<span class="number">2</span>, emp.getMgr());</span><br><span class="line">        ps.setDate(<span class="number">3</span>, emp.getHiredate());</span><br><span class="line">        ps.setInt(<span class="number">4</span>, emp.getDeptno());</span><br><span class="line">        ps.setDouble(<span class="number">5</span>, emp.getSalary());</span><br><span class="line">        ps.setDouble(<span class="number">6</span>, emp.getComm());</span><br><span class="line">        ps.setInt(<span class="number">7</span>, emp.getEmpno());</span><br><span class="line">        <span class="keyword">int</span> n = ps.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">    Emp emp = dao.findByEmpno(<span class="number">2</span>);</span><br><span class="line">    System.out.println(emp);</span><br><span class="line">    emp.setEname(<span class="string">"杰瑞"</span>);</span><br><span class="line">    <span class="keyword">int</span> n = dao.updateEmp(emp);</span><br><span class="line">    System.out.println(n); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加 EditEmpServlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EditEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 处理 get 请求 URL /edit-emp</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">           String no = request.getParameter(<span class="string">"empno"</span>);</span><br><span class="line">           <span class="keyword">int</span> empno = Integer.parseInt(no);</span><br><span class="line">           EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">           Emp emp = dao.findByEmpno(empno);</span><br><span class="line">   </span><br><span class="line">           List&lt;Emp&gt; mgrs = dao.findMgrs();</span><br><span class="line">   </span><br><span class="line">           request.setAttribute(<span class="string">"mgrs"</span>, mgrs);</span><br><span class="line">           request.setAttribute(<span class="string">"emp"</span>, emp);</span><br><span class="line">           request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/edit-emp.jsp"</span>)</span><br><span class="line">.forward(request, response); </span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>EditEmpServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>EditEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day07.EditEmpServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>EditEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/edit-emp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写 edit-emp.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">  <span class="comment">//获取EditEmpServlet共享的 emp 对象</span></span><br><span class="line">  Emp emp = (Emp) request.getAttribute(<span class="string">"emp"</span>); </span><br><span class="line">%&gt;        </span><br><span class="line">&lt;!-- Horizontal Form --&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box box-info"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-header with-border"</span>&gt;</span><br><span class="line">    &lt;h3 class="box-title"&gt;添加新员工信息&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- /.box-header --&gt;</span><br><span class="line">  &lt;!-- form start --&gt;</span><br><span class="line">  &lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-horizontal"</span> </span><br><span class="line">    method=<span class="string">"post"</span> action=<span class="string">"update-emp"</span>&gt; </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-body"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"empno"</span> </span><br><span class="line">          class="col-sm-2 control-label"&gt;员工号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">            id=<span class="string">"empno"</span> name=<span class="string">"empno"</span> placeholder=<span class="string">"员工号"</span></span><br><span class="line">            value=<span class="string">"&lt;%=emp.getEmpno()%&gt;"</span></span><br><span class="line">            readonly=<span class="string">"readonly"</span> &gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"ename"</span> </span><br><span class="line">          class="col-sm-2 control-label"&gt;姓名&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">            id=<span class="string">"ename"</span> name=<span class="string">"ename"</span> placeholder=<span class="string">"姓名"</span></span><br><span class="line">            value=<span class="string">"&lt;%=emp.getEname()%&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"mgr"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;领导&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;%</span><br><span class="line">            List&lt;Emp&gt; mgrs=(List&lt;Emp&gt;)request.getAttribute(<span class="string">"mgrs"</span>);</span><br><span class="line">          %&gt;</span><br><span class="line">          &lt;select <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> id=<span class="string">"mgr"</span> name=<span class="string">"mgr"</span>&gt;</span><br><span class="line">            &lt;%<span class="keyword">for</span>(Emp mgr:mgrs)&#123;%&gt;</span><br><span class="line">            &lt;!-- 客户端选中员工名，发送到服务器是对应的员工号</span><br><span class="line">             value属性是发送到服务器上的值 --&gt;</span><br><span class="line">            &lt;%  <span class="keyword">if</span>(mgr.getEmpno()==emp.getMgr())&#123;%&gt;</span><br><span class="line">                  &lt;option value=<span class="string">"&lt;%=mgr.getEmpno()%&gt;"</span> </span><br><span class="line">                    selected=<span class="string">"selected"</span>&gt;</span><br><span class="line">                    &lt;%=mgr.getEname()%&gt;</span><br><span class="line">                  &lt;/option&gt;</span><br><span class="line">            &lt;%  &#125; <span class="keyword">else</span> &#123; %&gt;</span><br><span class="line">                  &lt;option value=<span class="string">"&lt;%=mgr.getEmpno()%&gt;"</span> &gt;</span><br><span class="line">                    &lt;%=mgr.getEname()%&gt;</span><br><span class="line">                  &lt;/option&gt;                     </span><br><span class="line">            &lt;%  &#125;%&gt;</span><br><span class="line">            &lt;%&#125;%&gt;</span><br><span class="line">          &lt;/select&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"hiredate"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;入职日期&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"date"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"hiredate"</span> name=<span class="string">"hiredate"</span>  </span><br><span class="line">          placeholder=<span class="string">"入职日期"</span> </span><br><span class="line">          value=<span class="string">"&lt;%=emp.getHiredate()%&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"deptno"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;部门编号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"deptno"</span> name=<span class="string">"deptno"</span>  </span><br><span class="line">          placeholder=<span class="string">"部门编号"</span></span><br><span class="line">          value=<span class="string">"&lt;%=emp.getDeptno()%&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"salary"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;薪资&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"salary"</span> name=<span class="string">"salary"</span>  </span><br><span class="line">          placeholder=<span class="string">"薪资"</span></span><br><span class="line">          value=<span class="string">"&lt;%=emp.getSalary()%&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"comm"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;提成&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"comm"</span> name=<span class="string">"comm"</span>  </span><br><span class="line">          placeholder=<span class="string">"提成"</span></span><br><span class="line">          value=<span class="string">"&lt;%=emp.getComm()%&gt;"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;                                </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-body --&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-footer"</span>&gt;</span><br><span class="line">      &lt;button type="submit" class="btn btn-info pull-right"&gt;保存&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-footer --&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- /.box --&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试，显示编辑界面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/Servlet07/edit-emp?empno=3</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写UpdateEmpServlet 处理表单Post请求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 处理 post 请求， URL: /update-emp </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">           request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">           String no = request.getParameter(<span class="string">"empno"</span>);</span><br><span class="line">           String ename=request.getParameter(<span class="string">"ename"</span>);</span><br><span class="line">           String mgrno=request.getParameter(<span class="string">"mgr"</span>);</span><br><span class="line">           String hire=request.getParameter(<span class="string">"hiredate"</span>);</span><br><span class="line">           String dept=request.getParameter(<span class="string">"deptno"</span>);</span><br><span class="line">           String sly =request.getParameter(<span class="string">"salary"</span>);</span><br><span class="line">           String com =request.getParameter(<span class="string">"comm"</span>);</span><br><span class="line">           <span class="keyword">int</span> empno = Integer.parseInt(no);</span><br><span class="line">           <span class="keyword">int</span> mgr = Integer.parseInt(mgrno);</span><br><span class="line">           <span class="comment">//java.sql.Date 提供了将字符串转换为日期的方法</span></span><br><span class="line">           Date hiredate = Date.valueOf(hire);</span><br><span class="line">           <span class="keyword">int</span> deptno = Integer.parseInt(dept);</span><br><span class="line">           <span class="keyword">double</span> salary = Double.parseDouble(sly);</span><br><span class="line">           <span class="keyword">double</span> comm = Double.parseDouble(com);</span><br><span class="line">   </span><br><span class="line">           Emp emp = <span class="keyword">new</span> Emp(empno, ename, mgr, hiredate, deptno, salary, comm);</span><br><span class="line">           EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">           <span class="comment">//更新数据</span></span><br><span class="line">           <span class="keyword">int</span> n = dao.updateEmp(emp);</span><br><span class="line">           <span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">               String path=request.getContextPath()+<span class="string">"/list-emp"</span>;</span><br><span class="line">               response.sendRedirect(path); </span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               request.setAttribute(<span class="string">"message"</span>, <span class="string">"更新失败！"</span>);</span><br><span class="line">               request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/message.jsp"</span>)</span><br><span class="line">.forward(request, response);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新 list-emp2.jsp 添加编辑员工信息按钮</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;&lt;a onclick=<span class="string">"return confirm('真的删除?吗?')"</span> </span><br><span class="line">  href=<span class="string">"delete?empno=&lt;%=emp.getEmpno()%&gt;"</span> </span><br><span class="line">  <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-danger btn-xs"</span></span><br><span class="line">  &gt;&lt;i class="fa fa-fw fa-remove"&gt;&lt;/i&gt;&lt;/a&gt;</span><br><span class="line">  &lt;a href=<span class="string">"edit-emp?empno=&lt;%=emp.getEmpno()%&gt;"</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-success btn-xs"</span>&gt;&lt;i </span><br><span class="line">    class="fa fa-fw fa-edit"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<h2 id="网页的包含"><a href="#网页的包含" class="headerlink" title="网页的包含"></a>网页的包含</h2><p>一个网页包含了另外一个网页组件， 最后合并为一个页面，称为包含<br>JSP提供两个包含方式</p>
<ol>
<li><p>静态包含： 翻译期间会将两个JSP合并为一个Servlet，运行期间执行一个Servlet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ include file=&quot;从页面文件地址&quot;%&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>动态包含： 翻译期间生成两个Servlet，运行期间一个Serlvet动态调用了另外一个Servlet</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=&quot;header.jsp&quot;&gt;&lt;/jsp:include&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>两个包含方式，结果差别不大，一般采用动态包含编程更加方便。</p>
</blockquote>
<p>案例：</p>
<ol>
<li><p>被包含页面 header.jsp</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">  头部</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>静态包含：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- 静态包含 header.jsp, 两个网页在翻译期间合并为同一个 --&gt;</span><br><span class="line">  &lt;%@ include file=<span class="string">"header.jsp"</span> %&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    内容</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>动态包含：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">  language=<span class="string">"java"</span> </span><br><span class="line">  contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">  pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;!-- 动态 header.jsp, 两个网页分别编译为Servlet --&gt;</span><br><span class="line">  &lt;jsp:include page="header.jsp"&gt;&lt;/jsp:include&gt; </span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    内容</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="将员工管理拆分为包含方式："><a href="#将员工管理拆分为包含方式：" class="headerlink" title="将员工管理拆分为包含方式："></a>将员工管理拆分为包含方式：</h2><ol>
<li>创建页面组件 /WEB-INF/include<ol>
<li>header.jsp</li>
<li>footer.jsp</li>
<li>left-side.jsp</li>
<li>sidebar.jsp</li>
</ol>
</li>
<li>重构页面 list-emp2.jsp<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">    language=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">    <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span></span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">This is a starter template page. Use <span class="keyword">this</span> page to start your <span class="keyword">new</span> project from</span><br><span class="line">scratch. This page gets rid of all links and provides the needed markup only.</span><br><span class="line">--&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"IE=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;AdminLTE 2 | Starter&lt;/title&gt;</span><br><span class="line">  &lt;!-- Tell the browser to be responsive to screen width --&gt;</span><br><span class="line">  &lt;meta content=<span class="string">"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"</span> name=<span class="string">"viewport"</span>&gt;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"bower_components/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span><br><span class="line">  &lt;!-- Font Awesome --&gt;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"bower_components/font-awesome/css/font-awesome.min.css"</span>&gt;</span><br><span class="line">  &lt;!-- Ionicons --&gt;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"bower_components/Ionicons/css/ionicons.min.css"</span>&gt;</span><br><span class="line">  &lt;!-- Theme style --&gt;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"dist/css/AdminLTE.min.css"</span>&gt;</span><br><span class="line">  &lt;!-- AdminLTE Skins. We have chosen the skin-blue <span class="keyword">for</span> <span class="keyword">this</span> starter</span><br><span class="line">        page. However, you can choose any other skin. Make sure you</span><br><span class="line">        apply the skin <span class="class"><span class="keyword">class</span> <span class="title">to</span> <span class="title">the</span> <span class="title">body</span> <span class="title">tag</span> <span class="title">so</span> <span class="title">the</span> <span class="title">changes</span> <span class="title">take</span> <span class="title">effect</span>. --&gt;</span></span><br><span class="line"><span class="class">  &lt;<span class="title">link</span> <span class="title">rel</span></span>=<span class="string">"stylesheet"</span> href=<span class="string">"dist/css/skins/skin-blue.min.css"</span>&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;</span><br><span class="line">  &lt;!-- WARNING: Respond.js doesn<span class="string">'t work if you view the page via file:// --&gt;</span></span><br><span class="line"><span class="string">  &lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="string">  &lt;script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;![endif]--&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;!--</span></span><br><span class="line"><span class="string">BODY TAG OPTIONS:</span></span><br><span class="line"><span class="string">=================</span></span><br><span class="line"><span class="string">Apply one or more of the following classes to get the</span></span><br><span class="line"><span class="string">desired effect</span></span><br><span class="line"><span class="string">|---------------------------------------------------------|</span></span><br><span class="line"><span class="string">| SKINS         | skin-blue                               |</span></span><br><span class="line"><span class="string">|               | skin-black                              |</span></span><br><span class="line"><span class="string">|               | skin-purple                             |</span></span><br><span class="line"><span class="string">|               | skin-yellow                             |</span></span><br><span class="line"><span class="string">|               | skin-red                                |</span></span><br><span class="line"><span class="string">|               | skin-green                              |</span></span><br><span class="line"><span class="string">|---------------------------------------------------------|</span></span><br><span class="line"><span class="string">|LAYOUT OPTIONS | fixed                                   |</span></span><br><span class="line"><span class="string">|               | layout-boxed                            |</span></span><br><span class="line"><span class="string">|               | layout-top-nav                          |</span></span><br><span class="line"><span class="string">|               | sidebar-collapse                        |</span></span><br><span class="line"><span class="string">|               | sidebar-mini                            |</span></span><br><span class="line"><span class="string">|---------------------------------------------------------|</span></span><br><span class="line"><span class="string">--&gt;</span></span><br><span class="line"><span class="string">&lt;body class="hold-transition skin-blue sidebar-mini"&gt;</span></span><br><span class="line"><span class="string">&lt;div class="wrapper"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;!-- Main Header 包含子页面  --&gt;</span></span><br><span class="line"><span class="string">  &lt;jsp:include page="/WEB-INF/include/header.jsp"&gt;&lt;/jsp:include&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;!-- Left side 包含子页面 --&gt;</span></span><br><span class="line"><span class="string">  &lt;jsp:include page="/WEB-INF/include/left-side.jsp"&gt;&lt;/jsp:include&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;!-- Content Wrapper. Contains page content --&gt;</span></span><br><span class="line"><span class="string">  &lt;div class="content-wrapper"&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- Content Header (Page header) --&gt;</span></span><br><span class="line"><span class="string">    &lt;section class="content-header"&gt;</span></span><br><span class="line"><span class="string">      &lt;h1&gt;</span></span><br><span class="line"><span class="string">        Page Header</span></span><br><span class="line"><span class="string">        &lt;small&gt;Optional description&lt;/small&gt;</span></span><br><span class="line"><span class="string">      &lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;ol class="breadcrumb"&gt;</span></span><br><span class="line"><span class="string">        &lt;li&gt;&lt;a href="#"&gt;&lt;i class="fa fa-dashboard"&gt;&lt;/i&gt; Level&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;li class="active"&gt;Here&lt;/li&gt;</span></span><br><span class="line"><span class="string">      &lt;/ol&gt;</span></span><br><span class="line"><span class="string">    &lt;/section&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;!-- Main content --&gt;</span></span><br><span class="line"><span class="string">    &lt;section class="content container-fluid"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">      &lt;!--------------------------</span></span><br><span class="line"><span class="string">        | Your Page Content Here |</span></span><br><span class="line"><span class="string">        --------------------------&gt;</span></span><br><span class="line"><span class="string">          &lt;div class="box"&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="box-header with-border"&gt;</span></span><br><span class="line"><span class="string">              &lt;h3 class="box-title"&gt;员工信息  </span></span><br><span class="line"><span class="string">                 &lt;a href="add-emp" class="btn btn-success"&gt;&lt;i class="fa fa-user-plus"&gt;&lt;/i&gt; 添加&lt;/a&gt;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- /.box-header --&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="box-body"&gt;</span></span><br><span class="line"><span class="string">              &lt;table class="table table-bordered"&gt;</span></span><br><span class="line"><span class="string">                &lt;tr&gt;</span></span><br><span class="line"><span class="string">                  &lt;th style="width: 10px"&gt;#&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;姓名&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;老板&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;入职日期&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;部门编号&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;薪资&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;提成&lt;/th&gt;</span></span><br><span class="line"><span class="string">                  &lt;th&gt;&lt;/th&gt;</span></span><br><span class="line"><span class="string">                &lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;% </span></span><br><span class="line"><span class="string">  List&lt;Emp&gt; list =</span></span><br><span class="line"><span class="string">      (List&lt;Emp&gt;)request.getAttribute("list");</span></span><br><span class="line"><span class="string">%&gt;              </span></span><br><span class="line"><span class="string">                &lt;%for(Emp emp:list)&#123;%&gt;  </span></span><br><span class="line"><span class="string">                &lt;tr&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getEmpno()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getEname()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getMgr()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getHiredate()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getDeptno()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getSalary()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;%=emp.getComm()%&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                  &lt;!-- onclick中出现"return false" 则会阻止事件</span></span><br><span class="line"><span class="string">                  -点击事件的响应 --&gt;</span></span><br><span class="line"><span class="string">                  &lt;td&gt;&lt;a onclick="return confirm('</span>真的删除?吗?<span class="string">')" </span></span><br><span class="line"><span class="string">                    href="delete?empno=&lt;%=emp.getEmpno()%&gt;" </span></span><br><span class="line"><span class="string">                    class="btn btn-danger btn-xs"</span></span><br><span class="line"><span class="string">                    &gt;&lt;i class="fa fa-fw fa-remove"&gt;&lt;/i&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="string">                    &lt;a href="edit-emp?empno=&lt;%=emp.getEmpno()%&gt;"</span></span><br><span class="line"><span class="string">                      class="btn btn-success btn-xs"&gt;&lt;i </span></span><br><span class="line"><span class="string">                      class="fa fa-fw fa-edit"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                &lt;/tr&gt;</span></span><br><span class="line"><span class="string">                &lt;%&#125;%&gt;</span></span><br><span class="line"><span class="string">              &lt;/table&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;!-- /.box-body --&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="box-footer clearfix"&gt;</span></span><br><span class="line"><span class="string">              &lt;ul class="pagination pagination-sm no-margin pull-right"&gt;</span></span><br><span class="line"><span class="string">                &lt;li&gt;&lt;a href="#"&gt;&amp;laquo;&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">                &lt;li&gt;&lt;a href="#"&gt;1&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">                &lt;li&gt;&lt;a href="#"&gt;2&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">                &lt;li&gt;&lt;a href="#"&gt;3&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">                &lt;li&gt;&lt;a href="#"&gt;&amp;raquo;&lt;/a&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="string">              &lt;/ul&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;!-- /.box --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;/section&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- /.content --&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;!-- /.content-wrapper --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;!-- Main Footer 包含 --&gt;</span></span><br><span class="line"><span class="string">  &lt;jsp:include page="/WEB-INF/include/footer.jsp"&gt;&lt;/jsp:include&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;!-- Control Sidebar 包含 --&gt;</span></span><br><span class="line"><span class="string">  &lt;jsp:include page="/WEB-INF/include/sidebar.jsp"&gt;&lt;/jsp:include&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;!-- ./wrapper --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;!-- REQUIRED JS SCRIPTS --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;!-- jQuery 3 --&gt;</span></span><br><span class="line"><span class="string">&lt;script src="bower_components/jquery/dist/jquery.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;!-- Bootstrap 3.3.7 --&gt;</span></span><br><span class="line"><span class="string">&lt;script src="bower_components/bootstrap/dist/js/bootstrap.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;!-- AdminLTE App --&gt;</span></span><br><span class="line"><span class="string">&lt;script src="dist/js/adminlte.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;!-- Optionally, you can add Slimscroll and FastClick plugins.</span></span><br><span class="line"><span class="string">     Both of these plugins are recommended to enhance the</span></span><br><span class="line"><span class="string">     user experience. --&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/09/JSP-case-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/09/JSP-case-1/" itemprop="url">JSP-case-1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-09T19:27:46+08:00">
                2019-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实现添加员工功能"><a href="#实现添加员工功能" class="headerlink" title="实现添加员工功能"></a>实现添加员工功能</h2><p>步骤:</p>
<ol>
<li><p>在员工列表页面list-emp2.jsp增加添加链接:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3 class="box-title"&gt;员工信息 &lt;a href="add-emp.jsp" class="btn btn-success"&gt;添加&lt;/a&gt;&lt;/h3&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据模板页面 starter.html 和 pages/forms/general.html创建 add-emp.jsp</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Horizontal Form --&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box box-info"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-header with-border"</span>&gt;</span><br><span class="line">    &lt;h3 class="box-title"&gt;添加新员工信息&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;!-- /.box-header --&gt;</span><br><span class="line">  &lt;!-- form start --&gt;</span><br><span class="line">  &lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-horizontal"</span> </span><br><span class="line">    method=<span class="string">"post"</span> action=<span class="string">"save-emp"</span>&gt; </span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-body"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"ename"</span> </span><br><span class="line">          class="col-sm-2 control-label"&gt;姓名&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">            id=<span class="string">"ename"</span> name=<span class="string">"ename"</span> placeholder=<span class="string">"姓名"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"mgr"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;领导编号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"mgr"</span> name=<span class="string">"mgr"</span> placeholder=<span class="string">"领导编号"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"hiredate"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;入职日期&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"date"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"hiredate"</span> name=<span class="string">"hiredate"</span>  </span><br><span class="line">          placeholder=<span class="string">"入职日期"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"deptno"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;部门编号&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"deptno"</span> name=<span class="string">"deptno"</span>  </span><br><span class="line">          placeholder=<span class="string">"部门编号"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"salary"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;薪资&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"salary"</span> name=<span class="string">"salary"</span>  </span><br><span class="line">          placeholder=<span class="string">"薪资"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;  </span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-group"</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">"comm"</span> </span><br><span class="line">        class="col-sm-2 control-label"&gt;提成&lt;/label&gt;</span><br><span class="line">        &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"col-sm-10"</span>&gt;</span><br><span class="line">          &lt;input type=<span class="string">"number"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> </span><br><span class="line">          id=<span class="string">"comm"</span> name=<span class="string">"comm"</span>  </span><br><span class="line">          placeholder=<span class="string">"提成"</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;                                </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-body --&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"box-footer"</span>&gt;</span><br><span class="line">      &lt;button type="submit" class="btn btn-info pull-right"&gt;保存&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- /.box-footer --&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- /.box --&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在EmpDao中添加 save(emp) 方法, 实现增加Emp对象的功能.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加新用户功能</span></span><br><span class="line"><span class="comment"> * 返回添加的行数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">save</span><span class="params">(Emp emp)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//将emp对象中的数据保存到 数据库</span></span><br><span class="line">    String sql = <span class="string">"insert into t_emp (empno, ename, mgr, hiredate, deptno, salary, comm) values (null, ?,?,?,?,?,? )"</span>;</span><br><span class="line">    <span class="keyword">try</span>(Connection conn=DBUtil.getConnection())&#123;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ps.setString(<span class="number">1</span>, emp.getEname());</span><br><span class="line">        ps.setInt(<span class="number">2</span>, emp.getMgr());</span><br><span class="line">        ps.setDate(<span class="number">3</span>, emp.getHiredate());</span><br><span class="line">        ps.setInt(<span class="number">4</span>, emp.getDeptno());</span><br><span class="line">        ps.setDouble(<span class="number">5</span>, emp.getSalary());</span><br><span class="line">        ps.setDouble(<span class="number">6</span>, emp.getComm());</span><br><span class="line">        <span class="keyword">int</span> n = ps.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        e.printStackTrace(); </span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试 save 方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCase</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSaveEmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Date date = <span class="keyword">new</span> Date(System.currentTimeMillis());</span><br><span class="line">        Emp emp = <span class="keyword">new</span> Emp(<span class="number">0</span>, <span class="string">"范传奇"</span>, <span class="number">1</span>, date,</span><br><span class="line">                <span class="number">1</span>, <span class="number">1000</span>, <span class="number">20</span>); </span><br><span class="line">        EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">        <span class="keyword">int</span> n = dao.save(emp);</span><br><span class="line">        System.out.println(n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Servlet, 处理表单post请求:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SaveEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1. 接收表单参数</span></span><br><span class="line">        <span class="comment">//2. 将表单参数保存到数据</span></span><br><span class="line">        <span class="comment">//3. 转发到 成功页面</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        String ename=request.getParameter(<span class="string">"ename"</span>);</span><br><span class="line">        String mgrId=request.getParameter(<span class="string">"mgr"</span>);</span><br><span class="line">        String date =request.getParameter(<span class="string">"hiredate"</span>);</span><br><span class="line">        String deptId=request.getParameter(<span class="string">"deptno"</span>);</span><br><span class="line">        String salarys=request.getParameter(<span class="string">"salary"</span>);</span><br><span class="line">        String comms = request.getParameter(<span class="string">"comm"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(ename);</span><br><span class="line">        System.out.println(mgrId);</span><br><span class="line">        System.out.println(date);</span><br><span class="line">        System.out.println(deptId);</span><br><span class="line">        System.out.println(salarys);</span><br><span class="line">        System.out.println(comms);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//数据类型转换: 将字符串转换为目标数据类型</span></span><br><span class="line">            SimpleDateFormat fmt= <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">            <span class="keyword">int</span> mgr = Integer.parseInt(mgrId);</span><br><span class="line">            Date hiredate = <span class="keyword">new</span> Date(fmt.parse(date).getTime());</span><br><span class="line">            <span class="keyword">int</span> deptno = Integer.parseInt(deptId);</span><br><span class="line">            <span class="keyword">double</span> salary = Double.parseDouble(salarys);</span><br><span class="line">            <span class="keyword">double</span> comm = Double.parseDouble(comms);</span><br><span class="line">            <span class="comment">//保存到数据库</span></span><br><span class="line">            Emp emp = <span class="keyword">new</span> Emp(<span class="number">0</span>, ename, mgr, hiredate, deptno, salary, comm);</span><br><span class="line">            EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">            <span class="keyword">int</span> n = dao.save(emp);</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="comment">//成功</span></span><br><span class="line">                request.setAttribute(<span class="string">"message"</span>, <span class="string">"添加成功!"</span>);</span><br><span class="line">                request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/message.jsp"</span>).forward(request, response);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//失败</span></span><br><span class="line">                request.setAttribute(<span class="string">"message"</span>, <span class="string">"添加失败!"</span>);</span><br><span class="line">                request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/message.jsp"</span>).forward(request, response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace(); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置Servlet</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>SaveEmpServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SaveEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day06.SaveEmpServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SaveEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/save-emp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>利用starter.html 创建 /WEB-INF/jsp/message.jsp 用于显示成功消息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;p class=<span class="string">"well"</span>&gt;</span><br><span class="line">  &lt;%=request.getAttribute(<span class="string">"message"</span>)%&gt;</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<h2 id="转发-与-重定向"><a href="#转发-与-重定向" class="headerlink" title="转发 与 重定向"></a>转发 与 重定向</h2><ol>
<li>转发: 一次请求<ol>
<li>为了实现 Servlet与JSP协同工作, Sertvlet处理结束以后由JSP负责显示数据, SUN 设计 Servlet到JSP的转发功能.(尽管Servlet到Servlet, JSP到JSP可以转发, 但极少使用)</li>
<li>一般都在Servlet处理以后, 转发到JSP显示数据!!</li>
</ol>
</li>
<li>重定向: 两次请求<ol>
<li>是HTTP协议中设计的一个功能, 浏览器根据服务器的响应结果自动转向(跳转)到一个新的URL地址.</li>
<li>服务在响应中发送 302 状态码和Location头, 浏览器收到302就会转向到 Location头中设定的URL地址.</li>
<li>如果服务器端希望重新转向新的URL地址(发起新的GET请求)时候使用重定向.</li>
</ol>
</li>
</ol>
<p>重构SaveEmpServlet利用重定向显示添加的结果:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">    String url= request.getContextPath()+<span class="string">"/list-emp"</span>;</span><br><span class="line">    response.sendRedirect(url); </span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//失败</span></span><br><span class="line">    request.setAttribute(<span class="string">"message"</span>, <span class="string">"添加失败!"</span>);</span><br><span class="line">    request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/message.jsp"</span>) .forward(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="实现删除功能"><a href="#实现删除功能" class="headerlink" title="实现删除功能:"></a>实现删除功能:</h2><p>步骤:</p>
<ol>
<li><p>EmpDao中添加delete方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 按照员工号删除员工信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delete</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">    String sql=<span class="string">"delete from t_emp where empno=?"</span>;</span><br><span class="line">    <span class="keyword">try</span>(Connection conn=DBUtil.getConnection())&#123;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ps.setInt(<span class="number">1</span>, empno);</span><br><span class="line">        <span class="keyword">int</span> n = ps.executeUpdate();</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteEmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">    <span class="keyword">int</span> n = dao.delete(<span class="number">4</span>);</span><br><span class="line">    System.out.println(n); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改list-emp2.jsp 添加删除链接:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;table <span class="class"><span class="keyword">class</span></span>=<span class="string">"table table-bordered"</span>&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">  &lt;th style="width: 10px"&gt;#&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;姓名&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;老板&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;入职日期&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;部门编号&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;薪资&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;提成&lt;/th&gt;</span><br><span class="line">  &lt;th&gt;&lt;/th&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;% </span><br><span class="line">  List&lt;Emp&gt; list =</span><br><span class="line">      (List&lt;Emp&gt;)request.getAttribute(<span class="string">"list"</span>);</span><br><span class="line">%&gt;              </span><br><span class="line">&lt;%<span class="keyword">for</span>(Emp emp:list)&#123;%&gt;  </span><br><span class="line">&lt;tr&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getEmpno()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getEname()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getMgr()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getHiredate()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getDeptno()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getSalary()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;td&gt;&lt;%=emp.getComm()%&gt;&lt;/td&gt;</span><br><span class="line">  &lt;!-- onclick中出现<span class="string">"return false"</span> 则会阻止事件</span><br><span class="line">  -点击事件的响应 --&gt;</span><br><span class="line">  &lt;td&gt;&lt;a onclick=<span class="string">"return confirm('真的删除?吗?')"</span> </span><br><span class="line">    href=<span class="string">"delete?empno=&lt;%=emp.getEmpno()%&gt;"</span> </span><br><span class="line">    <span class="class"><span class="keyword">class</span></span>=<span class="string">"btn btn-danger btn-xs"</span></span><br><span class="line">    &gt;&lt;i class="fa fa-fw fa-remove"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;%&#125;%&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeleteEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">   </span><br><span class="line">       <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">           String no = request.getParameter(<span class="string">"empno"</span>);</span><br><span class="line">           <span class="comment">//请自行打桩测试接收到的参数是否有效</span></span><br><span class="line">           <span class="keyword">int</span> empno = Integer.parseInt(no);</span><br><span class="line">           <span class="comment">//调用EmpDao删除数据</span></span><br><span class="line">           EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">           <span class="keyword">int</span> n = dao.delete(empno);</span><br><span class="line">           <span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">               <span class="comment">//重定向到 员工列表页面, 显示结果</span></span><br><span class="line">               String path=request.getContextPath()+<span class="string">"/list-emp"</span>;</span><br><span class="line">               response.sendRedirect(path);</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="comment">//转发到message.jsp显示错误消息</span></span><br><span class="line">               request.setAttribute(<span class="string">"message"</span>, <span class="string">"删除失败"</span>);</span><br><span class="line">               request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/message.jsp"</span>)</span><br><span class="line">.forward(request, response); </span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/09/JSP-Java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/09/JSP-Java/" itemprop="url">JSP-Java</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-09T17:30:46+08:00">
                2019-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><p>JSP: Java服务器页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">J-Java</span><br><span class="line">S-Server</span><br><span class="line">P-Page</span><br></pre></td></tr></table></figure></p>
<ol>
<li>历史上 微软公司首先提供了 ASP 技术, 很受欢迎</li>
<li>SUN根据ASP的风格基于Servlet技术, 设计了JSP</li>
<li>JSP就是Servlet</li>
</ol>
<p>JSP编程好处:</p>
<ol>
<li>JSP 页面基于HTML页面, 传统的HTML开发工具可以写JSP</li>
<li>在运行时候 JSP 被翻译成 .java 文件(Servlet) 再编译为.class</li>
<li>执行时候执行class文件.</li>
<li><p>JSP自动部署, 不用写web.xml</p>
<blockquote>
<p>JSP 的优势在于 使用HTML风格编码编写Servlet类! JSP非常适合显示网页符数据.</p>
</blockquote>
</li>
</ol>
<p><strong>JSP Hello World!</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=utf-8"</span> pageEncoding=<span class="string">"utf-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;第一个JSP&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;第一个JSP&lt;/h1&gt;</span><br><span class="line">    &lt;!-- JSP 中可以嵌入 <span class="string">"Java 程序脚本"</span> --&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        String str = <span class="string">"Hello World!"</span>;</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;!-- JSP 表达式, 用于计算表达式值 --&gt;</span><br><span class="line">    &lt;p&gt;&lt;%=str%&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="JSP运行原理"><a href="#JSP运行原理" class="headerlink" title="JSP运行原理"></a>JSP运行原理</h2><p>JSP运行过程:</p>
<ul>
<li>第一次请求JSP时候<ol>
<li>先将JSP翻译为一个 Servlet 源程序(.java)</li>
<li>再将Servlet源程序编译为.class文件</li>
<li>创建Servlet对象</li>
<li>执行Servlet对象的 service 方法, 处理请求与响应</li>
</ol>
</li>
<li>第二次请求JSP时候<ol>
<li>如果JSP被编辑过则重新走流程 1</li>
<li>如果JSP没有被编辑过, 则执行执行Servlet对象的 service 方法</li>
</ol>
</li>
</ul>
<h2 id="JSP-中的Java"><a href="#JSP-中的Java" class="headerlink" title="JSP 中的Java"></a>JSP 中的Java</h2><ol>
<li>Java 脚本 : 用于处理程序逻辑, 可以写任意语句, 流程控制等<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//Java 脚本 </span></span><br><span class="line">    <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">long</span> year = now/<span class="number">1000</span>/<span class="number">60</span>/<span class="number">60</span>/<span class="number">24</span>/<span class="number">365</span> + <span class="number">1970</span>;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>Java 脚本中的语句会翻译到 service 方法中的语句</p>
<ol start="2">
<li>Java 表达式: 用于计算并且输出表达式<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- JSP 表达式, 用于计算表达式值并且在网页上输出--&gt;</span><br><span class="line">&lt;p&gt;&lt;%=now/1000%60%&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;%=year%&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;%=add(times, 1)%&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<ol start="3">
<li>Java 声明: 用于为Servlet声明成员<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- JSP 中的<span class="string">"声明"</span>,  --&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="comment">//用于为当前类声明 属性/方法/静态成员等</span></span><br><span class="line">    <span class="comment">//编译以后会成为 Servlet 中的成员</span></span><br><span class="line">    <span class="keyword">int</span> times = <span class="number">55</span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>案例:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=utf-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"utf-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Java 程序&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;JSP中的Java&lt;/h1&gt;</span><br><span class="line">    &lt;!-- JSP 中的<span class="string">"声明"</span>,  --&gt;</span><br><span class="line">    &lt;%!</span><br><span class="line">        <span class="comment">//用于为当前类声明 属性/方法/静态成员等</span></span><br><span class="line">        <span class="comment">//编译以后会成为 Servlet 中的成员</span></span><br><span class="line">        <span class="keyword">int</span> times = <span class="number">55</span>;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a+b;</span><br><span class="line">        &#125;</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//Java 脚本 </span></span><br><span class="line">        <span class="keyword">long</span> now = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">long</span> year = now/<span class="number">1000</span>/<span class="number">60</span>/<span class="number">60</span>/<span class="number">24</span>/<span class="number">365</span> + <span class="number">1970</span>;</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;!-- JSP 表达式, 用于计算表达式值并且在网页上输出--&gt;</span><br><span class="line">    &lt;p&gt;&lt;%=now/1000%60%&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;%=year%&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;%=add(times, 1)%&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="page-指令"><a href="#page-指令" class="headerlink" title="page 指令"></a>page 指令</h2><p>使用 &lt;%@ page %&gt; 声明page 指令</p>
<ol>
<li>必须写在JSP的第一行</li>
<li>属性:<ul>
<li>language=java 可以省略, 省略就是Java, 只能Java</li>
<li>contentType=”text/html; charset=UTF-8” 就是 response.setContentType(…) 设置浏览器端的解析编码</li>
<li>pageEncoding=”UTF-8” 页面编码, 是告诉Tomcat读取当前网页时候的编码</li>
<li>import=”java.util.<em>,java.sql.</em>“ 导入组件</li>
</ul>
</li>
</ol>
<h2 id="JSP内置对象"><a href="#JSP内置对象" class="headerlink" title="JSP内置对象"></a>JSP内置对象</h2><ul>
<li>就是JSP中预先定义的引用, 引用了与JSP功能相关的对象.</li>
<li>可以随时使用引用调用对象的方法, 实现功能</li>
<li>一共有9个对象: 经常成为9大内置对象.<br>常用:</li>
</ul>
<ol>
<li>request HttpServletResuest</li>
<li>response HttpServletResponse</li>
<li>out JspWriter 功能与 PrintWriter 一致</li>
</ol>
<blockquote>
<p>考点: JSP out对象的类型: JspWriter</p>
</blockquote>
<p>比较常用:</p>
<ol>
<li>session HttpSession 类型, 用于存储与”用户会话”有关的数据.(以后讲)</li>
<li>application ServletContext 类型, 用于存储与当前Servlet容器有关的数据(后续专门讲)</li>
<li>pageContext PageContext, 页面”上下文Context”. PageContext是当前页面上下文, 是当前页面的大管家, 内部包含与JSP有关的全部资源.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pageContext.getRequest() 返回的对象就是 request</span><br><span class="line">pageContext.getResponse()  返回的对象就是 response对象</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>不常用:</p>
<ol>
<li>config : ServletConfig 用于读取 web.xml 的内容</li>
<li>page : Object类型, 是当前JSP对象(Servlet对象)的引用, 就是this</li>
<li>exception : Exception 类型, 当前网页是错误页面时候, 用于获取异常信息.</li>
</ol>
<p>案例:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">    language=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">    <span class="keyword">import</span>=<span class="string">"java.util.*,java.sql.*"</span> </span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    List&lt;String&gt; list=<span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">    <span class="comment">//演示request对象的功能: 读取请求中的数据</span></span><br><span class="line">    String ua = request.getHeader(<span class="string">"User-Agent"</span>);</span><br><span class="line">    <span class="comment">//演示response对象功能: 处理响应信息</span></span><br><span class="line">    response.setHeader(<span class="string">"message"</span>, <span class="string">"Hello World!"</span>); </span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;内置对象功能演示&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;User-Agent:</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//在p标签里面显示ua信息</span></span><br><span class="line">        out.println(ua); </span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//pageContext 页面上下文, 包含当前页面全部相关信息</span></span><br><span class="line">        <span class="comment">// pageContext.getOut() 返回对象就是 out 对象</span></span><br><span class="line">        <span class="comment">// 其功能与out对象相同</span></span><br><span class="line">        JspWriter o = pageContext.getOut();</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;p&gt;User-Agent: &lt;% o.println(ua); %&gt; &lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="利用request对象共享数据"><a href="#利用request对象共享数据" class="headerlink" title="利用request对象共享数据"></a>利用request对象共享数据</h2><p>request内部封装了一个集合, 用于在一个请求期间共享数据。<br>主要用于在Servlet与JSP之间共享数据。<br>其主要API方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">request.setAttribute(key, value);</span><br><span class="line">Object value = request.getAttribute(key);</span><br><span class="line">request.removeAttribute(key);</span><br></pre></td></tr></table></figure></p>
<p>案例:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">    language=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">    <span class="keyword">import</span>=<span class="string">"java.util.*,java.sql.*"</span> </span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//将数据存储到 request中</span></span><br><span class="line">    request.setAttribute(<span class="string">"msg"</span>, <span class="string">"Hello World!"</span>);</span><br><span class="line">    request.setAttribute(<span class="string">"price"</span>, <span class="number">1234.0</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;利用request共享/传送数据&lt;/h1&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//接收request传递/共享的数据</span></span><br><span class="line">        String s = (String)request.getAttribute(<span class="string">"msg"</span>);</span><br><span class="line">        Double d = (Double)request.getAttribute(<span class="string">"price"</span>);</span><br><span class="line">        <span class="comment">//删除request中共享的数据</span></span><br><span class="line">        request.removeAttribute(<span class="string">"msg"</span>);</span><br><span class="line">        request.removeAttribute(<span class="string">"price"</span>);</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;p&gt;msg:&lt;%=s%&gt; price:&lt;%=d%&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="转发"><a href="#转发" class="headerlink" title="转发"></a>转发</h2><p>利用请求协作对象, 从Servlet转发到JSP。<br>SUN为了能够实现Servlet处理业务功能, 由JSP显示业务处理结果, 而设计了Servlet到JSP的转发功能。<br>案例:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//测试 从Servlet转发到JSP</span></span><br><span class="line">        <span class="comment">//1. 保存数据到 request 对象</span></span><br><span class="line">        request.setAttribute(<span class="string">"msg"</span>, <span class="string">"Hello World!"</span>);</span><br><span class="line">        <span class="comment">//2. 利用请求协作对象转发到一个JSP页面</span></span><br><span class="line">        RequestDispatcher rd=request.getRequestDispatcher(<span class="string">"demo03.jsp"</span>);</span><br><span class="line">        rd.forward(request, response);</span><br><span class="line">        <span class="comment">//注意!! 转发以后不能再处理网页内容, </span></span><br><span class="line">        <span class="comment">//包括向response输出信息, 或者再次转发!!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  &lt;servlet&gt;</span><br><span class="line">    &lt;description&gt;&lt;/description&gt;</span><br><span class="line">    &lt;display-name&gt;DemoServlet&lt;/display-name&gt;</span><br><span class="line">    &lt;servlet-name&gt;DemoServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">day05</span>.<span class="title">DemoServlet</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">servlet</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">servlet</span>-<span class="title">name</span>&gt;<span class="title">DemoServlet</span>&lt;/<span class="title">servlet</span>-<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">url</span>-<span class="title">pattern</span>&gt;/<span class="title">demo</span>&lt;/<span class="title">url</span>-<span class="title">pattern</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">servlet</span>-<span class="title">mapping</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;%@ <span class="title">page</span> </span></span><br><span class="line"><span class="class">    <span class="title">language</span></span>=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">    <span class="keyword">import</span>=<span class="string">"java.util.*,java.sql.*"</span> </span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;从Servlet转发到JSP&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&lt;%=request.getAttribute("msg")%&gt;&lt;/p&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="实现MVC版本的员工列表"><a href="#实现MVC版本的员工列表" class="headerlink" title="实现MVC版本的员工列表:"></a>实现MVC版本的员工列表:</h2><ol>
<li>DBUtil, Emp 等略</li>
<li><p>编写Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListEmpServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//利用Dao获取数据</span></span><br><span class="line">        EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">        List&lt;Emp&gt; list = dao.findAll();</span><br><span class="line">        <span class="comment">//利用request共享数据</span></span><br><span class="line">        request.setAttribute(<span class="string">"list"</span>, list); </span><br><span class="line">        <span class="comment">//转发到 list-emp.jsp, 显示员工列表</span></span><br><span class="line">        RequestDispatcher rd=request.getRequestDispatcher(<span class="string">"list-emp.jsp"</span>);</span><br><span class="line">        rd.forward(request, response); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day05.ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListEmpServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/list-emp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写JSP</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page </span><br><span class="line">    language=<span class="string">"java"</span> </span><br><span class="line">    contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">    <span class="keyword">import</span>=<span class="string">"java.util.*,entity.*"</span></span><br><span class="line">%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">&lt;title&gt;员工列表&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;员工列表&lt;/h1&gt;</span><br><span class="line">    &lt;table border=<span class="string">"1"</span>&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;编号&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;姓名&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;领导&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;入职日期&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;部门号&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;薪资&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;提成&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">&lt;% </span><br><span class="line">    List&lt;Emp&gt; list = </span><br><span class="line">        (List&lt;Emp&gt;)request.getAttribute(<span class="string">"list"</span>);</span><br><span class="line">%&gt;</span><br><span class="line">        &lt;%<span class="keyword">for</span>(Emp emp:list)&#123; %&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getEmpno()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getEname()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getMgr()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getHiredate()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getDeptno()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getSalary()%&gt;&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;&lt;%=emp.getComm()%&gt;&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;%&#125;%&gt;</span><br><span class="line">    &lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/09/Web-Servlet-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/09/Web-Servlet-2/" itemprop="url">Web-Servlet-2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-09T17:30:46+08:00">
                2019-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Request-接收表单参数"><a href="#Request-接收表单参数" class="headerlink" title="Request 接收表单参数"></a>Request 接收表单参数</h3><p>Request功能很多, 其主要作用就是处理浏览器请求. 用户通过表单提交的参数可以通过Request对象提供的API方法读取<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String name = request.getParamter(<span class="string">"name"</span>);</span><br></pre></td></tr></table></figure></p>
<p>案例:</p>
<ol>
<li><p>编写表单 webapp/login.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>登录表单<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用request对象接收表单参数<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 向 login url发起post请求 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"login"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>用户<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span>   </span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试显示表单</p>
</li>
<li><p>编写Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">     <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">         <span class="comment">//利用request的API获取表单参数</span></span><br><span class="line">         String name = request.getParameter(<span class="string">"user"</span>);</span><br><span class="line">         String pwd = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">         System.out.println(name+<span class="string">","</span>+pwd);</span><br><span class="line"> </span><br><span class="line">         response.setContentType(<span class="string">"text/html; charset=utf-8"</span>); </span><br><span class="line">         PrintWriter out=response.getWriter();</span><br><span class="line">         out.print(<span class="string">"OK"</span>); </span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="参数编码问题"><a href="#参数编码问题" class="headerlink" title="参数编码问题"></a>参数编码问题</h4><ol>
<li>网络和IO 每次只能传输一个字节(8位)信息!</li>
<li>字符是16位无符号整数</li>
<li>利用网络传输字符时候, 需要将字符进行拆分才能传输</li>
<li>字符的拆分方案称为字符的编码!</li>
</ol>
<p>Post请求时候, 在获取请求参数之前设置请求的编码可以解决编码问题.<br>案例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//在读取参数之前设置request的编码,处理解码问题</span></span><br><span class="line">        request.setCharacterEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">//利用request的API获取表单参数</span></span><br><span class="line">        String name = request.getParameter(<span class="string">"user"</span>);</span><br><span class="line">        String pwd = request.getParameter(<span class="string">"pwd"</span>);</span><br><span class="line">        System.out.println(name+<span class="string">","</span>+pwd);</span><br><span class="line">        response.setContentType(<span class="string">"text/html; charset=utf-8"</span>); </span><br><span class="line">        PrintWriter out=response.getWriter();</span><br><span class="line">        out.print(<span class="string">"OK"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="接收get请求参数"><a href="#接收get请求参数" class="headerlink" title="接收get请求参数"></a>接收get请求参数</h4><p>getParamter不仅可以接受post请求参数, 也可以接收get请求参数.<br>get编码问题可以在Tomcat配置文件server.xml中配置:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">"UTF-8"</span> <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">redirectPort</span>=<span class="string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>案例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetDemoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//接收浏览器通过 get 请求发送的参数</span></span><br><span class="line">        <span class="comment">//如果浏览器没有提供对应的参数, 则接收到null</span></span><br><span class="line">        String id=request.getParameter(<span class="string">"id"</span>);</span><br><span class="line">        String name=request.getParameter(<span class="string">"name"</span>);</span><br><span class="line">        System.out.println(id+<span class="string">", "</span>+name);</span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=UTF-8"</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        out.print(<span class="string">"OK"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>配置:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>GetDemoServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetDemoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day03.GetDemoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>GetDemoServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/get-demo<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="利用Servlet将数据库中的表显示到浏览器中"><a href="#利用Servlet将数据库中的表显示到浏览器中" class="headerlink" title="利用Servlet将数据库中的表显示到浏览器中"></a>利用Servlet将数据库中的表显示到浏览器中</h2><h4 id="1-创建表"><a href="#1-创建表" class="headerlink" title="1. 创建表"></a>1. 创建表</h4><p>创建员工表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">create database web;</span><br><span class="line">use web;</span><br><span class="line">create table t_emp(</span><br><span class="line">    empno int auto_increment primary key,</span><br><span class="line">    ename varchar(100),</span><br><span class="line">    mgr int,</span><br><span class="line">    deptno int,</span><br><span class="line">    hiredate datetime,</span><br><span class="line">    salary double,</span><br><span class="line">    comm double</span><br><span class="line">);</span><br><span class="line">insert into t_emp (empno, ename, mgr, deptno, hiredate, salary, comm)</span><br><span class="line">values (null, &apos;Tom&apos;, 0, null, now(), 1000, 200);</span><br><span class="line"></span><br><span class="line">insert into t_emp (empno, ename, mgr, deptno, hiredate, salary, comm)</span><br><span class="line">values (null, &apos;Jerry&apos;, 1, null, now(), 2000, 100);</span><br></pre></td></tr></table></figure></p>
<h4 id="2-编写数据库连接配置文件-db-properties"><a href="#2-编写数据库连接配置文件-db-properties" class="headerlink" title="2. 编写数据库连接配置文件 db.properties"></a>2. 编写数据库连接配置文件 db.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/web?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false</span><br><span class="line">username=root</span><br><span class="line">password=</span><br></pre></td></tr></table></figure>
<h4 id="3-编写数据库连接工具"><a href="#3-编写数据库连接工具" class="headerlink" title="3. 编写数据库连接工具"></a>3. 编写数据库连接工具</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String driver;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String url;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String username;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String password;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream in = DBUtil.class.getClassLoader().getResourceAsStream(<span class="string">"db.properties"</span>);</span><br><span class="line">            Properties cfg = <span class="keyword">new</span> Properties();</span><br><span class="line">            cfg.load(in);</span><br><span class="line">            in.close();</span><br><span class="line">            driver = cfg.getProperty(<span class="string">"driver"</span>);</span><br><span class="line">            url = cfg.getProperty(<span class="string">"url"</span>);</span><br><span class="line">            username=cfg.getProperty(<span class="string">"username"</span>);</span><br><span class="line">            password=cfg.getProperty(<span class="string">"password"</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class.forName(driver);</span><br><span class="line">        Connection conn = DriverManager.getConnection(url,username,password);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Connection conn)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(conn!=<span class="keyword">null</span>) &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-利用JUnit进行测试"><a href="#4-利用JUnit进行测试" class="headerlink" title="4. 利用JUnit进行测试:"></a>4. 利用JUnit进行测试:</h4><ol>
<li><p>导入JUnit</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试案例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCase</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello World!"</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello Kitty!"</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String sql = <span class="string">"select now() d"</span>;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DBUtil.getConnection();</span><br><span class="line">            Statement st = conn.createStatement();</span><br><span class="line">            ResultSet rs = st.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">                Date date=rs.getDate(<span class="string">"d"</span>);</span><br><span class="line">                System.out.println(date);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            DBUtil.close(conn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="5-编写Servlet-显示表内容"><a href="#5-编写Servlet-显示表内容" class="headerlink" title="5. 编写Servlet 显示表内容"></a>5. 编写Servlet 显示表内容</h4><p>代码:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//获得out对象</span></span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line"></span><br><span class="line">        out.println(<span class="string">"&lt;!DOCTYPE html&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;html&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;head&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;meta charset=\"UTF-8\"&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;title&gt;登录表单&lt;/title&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/head&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;body&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;h1&gt;员工列表&lt;/h1&gt;"</span>); </span><br><span class="line"></span><br><span class="line">        String sql=<span class="string">"select empno, ename, mgr, hiredate, deptno, salary, comm from t_emp"</span>;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DBUtil.getConnection();</span><br><span class="line">            Statement st = conn.createStatement();</span><br><span class="line">            ResultSet rs = st.executeQuery(sql);</span><br><span class="line">            <span class="comment">//输出表格头</span></span><br><span class="line">            out.println(<span class="string">"&lt;table&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;编号&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;姓名&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;入职日期&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">            <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> empno = rs.getInt(<span class="string">"empno"</span>);</span><br><span class="line">                String ename = rs.getString(<span class="string">"ename"</span>);</span><br><span class="line">                Date date = rs.getDate(<span class="string">"hiredate"</span>);</span><br><span class="line">                <span class="comment">//System.out.println(empno+","+ename);</span></span><br><span class="line">                out.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">                out.println(<span class="string">"&lt;td&gt;"</span>+empno+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">                out.println(<span class="string">"&lt;td&gt;"</span>+ename+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">                out.println(<span class="string">"&lt;td&gt;"</span>+date+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">                out.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            out.println(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBUtil.close(conn);</span><br><span class="line">        &#125;</span><br><span class="line">        out.println(<span class="string">"&lt;/body&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/html&gt;"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>配置:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day03.ListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/list<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>测试:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/Servlet03/list</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/09/Web-Servlet-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/09/Web-Servlet-3/" itemprop="url">Web-Servlet-3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-09T17:30:46+08:00">
                2019-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><p>数据库连接池负责分配、管理和释放数据库连接，它允许应用程序重复使用一个现有的数据库连接，而不是再重新建立一个。<br>在需求数据连接数超过可连接总数时候可以控制最大连接数, 避免连接过载, 保护数据库连接资源。<br>这项技术能明显提高对数据库操作的性能, 同时限制数据库连接总数避免资源过载。</p>
<ul>
<li>数据库连接池的管理策略</li>
</ul>
<ol>
<li>初始时候会创建一定数量的连接</li>
<li>在用户获取连接时候直接重用已有连接</li>
<li>在连接需求数量超过最大连接数时候, 控制连接总数</li>
<li>在连接池中的空闲连接较多时候, 会关闭连接多余的连接, 保持空闲连接数量</li>
</ol>
<p>使用步骤</p>
<ol>
<li><p>导入DBCP, MySQL JDBC, JUnit</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-dbcp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试案例:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCase</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDBCP</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//BasicDataSource 就是Apache提供的数据库</span></span><br><span class="line">        <span class="comment">//连接池组件, 使用步骤:</span></span><br><span class="line">        <span class="comment">//1. 创建连接池对象</span></span><br><span class="line">        <span class="comment">//2. 设置4个必须的连接池参数</span></span><br><span class="line">        <span class="comment">//    driverClass, url, username, password</span></span><br><span class="line">        <span class="comment">//3. 设置可选的数据库连接管理策略参数</span></span><br><span class="line">        <span class="comment">//    初始连接数: 先创建的连接数量</span></span><br><span class="line">        <span class="comment">//    最大连接数: 最多创建的连接数量</span></span><br><span class="line">        <span class="comment">//    空闲连接数: 连接用完以后保持连接数</span></span><br><span class="line">        <span class="comment">//    ...</span></span><br><span class="line">        BasicDataSource ds = <span class="keyword">new</span> BasicDataSource();</span><br><span class="line">        <span class="comment">//设置必须参数</span></span><br><span class="line">        ds.setDriverClassName(<span class="string">"com.mysql.jdbc.Driver"</span>); </span><br><span class="line">        ds.setUrl(<span class="string">"jdbc:mysql://localhost:3306/web"</span>); </span><br><span class="line">        ds.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        ds.setPassword(<span class="string">"root"</span>);</span><br><span class="line">        <span class="comment">//设置可选参数</span></span><br><span class="line">        ds.setInitialSize(<span class="number">5</span>); <span class="comment">//Initial: 初始的</span></span><br><span class="line">        ds.setMaxActive(<span class="number">50</span>);  <span class="comment">//最大连接数</span></span><br><span class="line">        ds.setMaxIdle(<span class="number">10</span>);    <span class="comment">//最大空闲(Idle)连接数</span></span><br><span class="line">        <span class="comment">//要合理设置可选参数. </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//从数据库连接池中拿到数据库连接</span></span><br><span class="line">        Connection conn = ds.getConnection();</span><br><span class="line">        String sql = <span class="string">"select 'Hello World' as s"</span>;</span><br><span class="line">        Statement st = conn.createStatement();</span><br><span class="line">        ResultSet rs=st.executeQuery(sql);</span><br><span class="line">        <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">            String s = rs.getString(<span class="string">"s"</span>);</span><br><span class="line">            System.out.println(s); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//执行close()方法, 将连接归还到连接池 </span></span><br><span class="line">        conn.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试:    利用数据库连接池重构 DBUtil</p>
</li>
<li><p>编写配置文件 db.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/web?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false</span><br><span class="line">username=root</span><br><span class="line">password=</span><br><span class="line">initial=5</span><br><span class="line">max=50</span><br><span class="line">idle=10</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写DBUtil类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> BasicDataSource ds;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        ds = <span class="keyword">new</span> BasicDataSource();</span><br><span class="line">        <span class="comment">//读取配置文件, 初始化连接池对象</span></span><br><span class="line">        Properties cfg = <span class="keyword">new</span> Properties();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream in = DBUtil.class.getClassLoader().getResourceAsStream(<span class="string">"db.properties"</span>);</span><br><span class="line">            cfg.load(in);</span><br><span class="line">            in.close();</span><br><span class="line">            String driver=cfg.getProperty(<span class="string">"driver"</span>);</span><br><span class="line">            String url=cfg.getProperty(<span class="string">"url"</span>);</span><br><span class="line">            String username=cfg.getProperty(<span class="string">"username"</span>);</span><br><span class="line">            String password=cfg.getProperty(<span class="string">"password"</span>);</span><br><span class="line">            <span class="keyword">int</span> initial=Integer.parseInt(cfg.getProperty(<span class="string">"initial"</span>));</span><br><span class="line">            <span class="keyword">int</span> max = Integer.parseInt(cfg.getProperty(<span class="string">"max"</span>));</span><br><span class="line">            <span class="keyword">int</span> idle = Integer.parseInt(cfg.getProperty(<span class="string">"idle"</span>)); </span><br><span class="line">            ds.setDriverClassName(driver);</span><br><span class="line">            ds.setUrl(url);</span><br><span class="line">            ds.setUsername(username);</span><br><span class="line">            ds.setPassword(password);</span><br><span class="line">            ds.setInitialSize(initial);</span><br><span class="line">            ds.setMaxActive(max);</span><br><span class="line">            ds.setMaxIdle(idle);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(Connection conn)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(conn!=<span class="keyword">null</span>) conn.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试案例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDBUitl</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//测试 DBUtil管理的连接池对象是否能够连接到数据库</span></span><br><span class="line">    <span class="comment">//从连接池拿到连接</span></span><br><span class="line">    Connection conn = DBUtil.getConnection();</span><br><span class="line">    String sql = <span class="string">"select 'DBCP' as s"</span>;</span><br><span class="line">    Statement st = conn.createStatement();</span><br><span class="line">    ResultSet rs = st.executeQuery(sql);</span><br><span class="line">    <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">        String str = rs.getString(<span class="string">"s"</span>);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">    DBUtil.close(conn); <span class="comment">//归还连接</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试</p>
</li>
</ol>
<h2 id="DAO-数据访问对象"><a href="#DAO-数据访问对象" class="headerlink" title="DAO 数据访问对象"></a>DAO 数据访问对象</h2><p>利用DAO将页面表现和数据访问进行分离</p>
<ol>
<li>将数据访问和页面表现加以分离</li>
<li>数据访问逻辑集中管理,方便维护</li>
<li>页面表现集中管理方便维护</li>
</ol>
<p>步骤</p>
<ol>
<li><p>创建Emp类, 用于封装数据:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建员工类, 封装员工数据 </span></span><br><span class="line"><span class="comment"> * 业务实体(entity)类, 封装业务数据的类 </span></span><br><span class="line"><span class="comment"> * 生成 有参构造器,  get set 方法, 生成toString</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> empno;</span><br><span class="line">    <span class="keyword">private</span> String ename;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mgr;</span><br><span class="line">    <span class="keyword">private</span> Date hiredate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> deptno;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> salary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> comm;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Emp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Emp</span><span class="params">(<span class="keyword">int</span> empno, String ename, <span class="keyword">int</span> mgr, Date hiredate, <span class="keyword">int</span> deptno, <span class="keyword">double</span> salary, <span class="keyword">double</span> comm)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.empno = empno;</span><br><span class="line">        <span class="keyword">this</span>.ename = ename;</span><br><span class="line">        <span class="keyword">this</span>.mgr = mgr;</span><br><span class="line">        <span class="keyword">this</span>.hiredate = hiredate;</span><br><span class="line">        <span class="keyword">this</span>.deptno = deptno;</span><br><span class="line">        <span class="keyword">this</span>.salary = salary;</span><br><span class="line">        <span class="keyword">this</span>.comm = comm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getEmpno</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> empno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmpno</span><span class="params">(<span class="keyword">int</span> empno)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.empno = empno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.ename = ename;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMgr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mgr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMgr</span><span class="params">(<span class="keyword">int</span> mgr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mgr = mgr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getHiredate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hiredate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHiredate</span><span class="params">(Date hiredate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hiredate = hiredate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDeptno</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> deptno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeptno</span><span class="params">(<span class="keyword">int</span> deptno)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.deptno = deptno;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> salary;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.salary = salary;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getComm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> comm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setComm</span><span class="params">(<span class="keyword">double</span> comm)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.comm = comm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Emp [empno="</span> + empno + <span class="string">", ename="</span> + ename + <span class="string">", mgr="</span> + mgr + <span class="string">", hiredate="</span> + hiredate + <span class="string">", deptno="</span> + deptno + <span class="string">", salary="</span> + salary + <span class="string">", comm="</span> + comm + <span class="string">"]"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建EmpDAO封装数据访问逻辑</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 封装对 Emp 表的数据访问功能 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmpDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从数据库中查询全部的员工数据, 封装到List</span></span><br><span class="line"><span class="comment">     * 返回, list中的每个元素是一个Emp对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 全部的员工数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String sql = <span class="string">"select empno, ename, mgr, hiredate, deptno, salary, comm from t_emp"</span>;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = DBUtil.getConnection();</span><br><span class="line">            Statement st = conn.createStatement();</span><br><span class="line">            ResultSet rs = st.executeQuery(sql);</span><br><span class="line">            List&lt;Emp&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">                <span class="keyword">int</span> empno = rs.getInt(<span class="string">"empno"</span>);</span><br><span class="line">                String ename = rs.getString(<span class="string">"ename"</span>);</span><br><span class="line">                <span class="keyword">int</span> mgr = rs.getInt(<span class="string">"mgr"</span>);</span><br><span class="line">                Date hiredate=rs.getDate(<span class="string">"hiredate"</span>);</span><br><span class="line">                <span class="keyword">int</span> deptno = rs.getInt(<span class="string">"deptno"</span>);</span><br><span class="line">                <span class="keyword">double</span> salary = rs.getDouble(<span class="string">"salary"</span>);</span><br><span class="line">                <span class="keyword">double</span> comm = rs.getDouble(<span class="string">"comm"</span>);</span><br><span class="line">                Emp emp = <span class="keyword">new</span> Emp(empno, ename, mgr, hiredate, deptno, salary, comm);</span><br><span class="line">                list.add(emp);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> list;<span class="comment">//正常结果</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="comment">//错误情况!</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e); <span class="comment">//错误结果</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBUtil.close(conn); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testEmpDao</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">    List&lt;Emp&gt; list = dao.findAll();</span><br><span class="line">    <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">        System.out.println(emp); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="利用EmpDao显示员工列表"><a href="#利用EmpDao显示员工列表" class="headerlink" title="利用EmpDao显示员工列表"></a>利用EmpDao显示员工列表</h2><ol>
<li><p>编写Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request,HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//获取全部需要显示的数据</span></span><br><span class="line">        EmpDao dao = <span class="keyword">new</span> EmpDao();</span><br><span class="line">        List&lt;Emp&gt; list = dao.findAll();</span><br><span class="line">        <span class="comment">//输出页面显示数据</span></span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        out.println(<span class="string">"&lt;!DOCTYPE html&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;html&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;head&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;meta charset=\"UTF-8\"&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/head&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;body&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;h1&gt;员工列表&lt;/h1&gt;"</span>);</span><br><span class="line">        <span class="comment">//遍历 list 集合拼接表格</span></span><br><span class="line">        out.println(<span class="string">"&lt;table border='1'&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;编号&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;姓名&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;领导&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;入职日期&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;部门号&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;薪资&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;td&gt;提成&lt;/td&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        <span class="keyword">for</span>(Emp emp : list) &#123;</span><br><span class="line">            out.println(<span class="string">"&lt;tr&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getEmpno()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getEname()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getMgr()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getHiredate()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getDeptno()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getSalary()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;td&gt;"</span>+emp.getComm()+<span class="string">"&lt;/td&gt;"</span>);</span><br><span class="line">            out.println(<span class="string">"&lt;/tr&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        out.println(<span class="string">"&lt;/table&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/body&gt;"</span>);</span><br><span class="line">        out.println(<span class="string">"&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">display-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day04.ListServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>ListServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/list<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署测试:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/Servlet04/list</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/09/Web-Servlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/09/Web-Servlet/" itemprop="url">Web-Servlet</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-09T17:30:46+08:00">
                2019-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h1><p>Servlet: 是指在在服务器上执行的程序片段.</p>
<ol>
<li>Servlet是JavaEE规范的一部分</li>
<li>用来解决Web服务器端编程问题</li>
<li>Servlet组件工作在Java Web服务器中</li>
</ol>
<h2 id="安装配置Tomcat服务器"><a href="#安装配置Tomcat服务器" class="headerlink" title="安装配置Tomcat服务器"></a>安装配置Tomcat服务器</h2><ol>
<li>下载Tomcat <a href="http://tomcat.apache.org/" target="_blank" rel="noopener">http://tomcat.apache.org</a></li>
<li>安装: 释放tomcat压缩包即可</li>
<li>在Eclipse中配置Tomcat<br>参考: <a href="http://doc.tedu.cn/tomcat/index.html" target="_blank" rel="noopener">http://doc.tedu.cn/tomcat/index.html</a></li>
</ol>
<h2 id="Servlet-Hello-World"><a href="#Servlet-Hello-World" class="headerlink" title="Servlet Hello World"></a>Servlet Hello World</h2><p>实现步骤</p>
<ol>
<li>创建 Maven Web 项目<ol>
<li>创建maven war项目(Eclipse必须能够连接到Mavne仓库)</li>
<li>在项目上 使用 右键创建 “部署描述文件 web.xml”</li>
</ol>
</li>
<li>导入Tomcat 目标服务器运行环境<ul>
<li>就是导入 Servlet 接口</li>
</ul>
</li>
<li><p>创建一个类 DemoServlet</p>
<ul>
<li>向response发送 Hello World<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">	    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig arg0)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">	    &#125;</span><br><span class="line">	</span><br><span class="line">	    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">	        response.setContentType(<span class="string">"text/html"</span>); </span><br><span class="line">	        <span class="comment">//将 Hello World 写到response中</span></span><br><span class="line">	        response.getWriter().print(<span class="string">"Hello World!"</span>);</span><br><span class="line">	    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>配置web.xml</p>
<ol>
<li>将请求路径 /hello 映射到 DemoServlet 上<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 登记 Servlet --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day01.DemoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 将Servlet 映射到 URL 连接 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>将web程序部署到 Tomcat 中</p>
<ul>
<li>部署就是复制, 将web.xml DemoServlet 等复制到Tomcat服务器中.</li>
</ul>
</li>
<li>使用浏览器请求 /hello, 在浏览器中看到 Hello World!<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/Servlet01/hello</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="请求与响应"><a href="#请求与响应" class="headerlink" title="请求与响应"></a>请求与响应</h1><h3 id="HttpServletRequest"><a href="#HttpServletRequest" class="headerlink" title="HttpServletRequest"></a>HttpServletRequest</h3><p>HttpServletRequest 简称 request 对象, 其父类型是 ServletRequest</p>
<ol>
<li>request 对象在Tomcat收到用户请求时候创建, 其内部封装的全部的用户浏览器请求信息.</li>
<li>ServletRequest类型定义的方法少, 转换为HttpServletRequest方法更多, 使用更加方便.</li>
<li>request对象提供了API方法, 利用这些方法可以读取用户浏览器请求的请求信息.</li>
</ol>
<p>案例:</p>
<ol>
<li><p>创建Servlet类:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestDemoServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">       <span class="comment">//由于getMethod方法是HttpServletRequest对象的方法</span></span><br><span class="line">       <span class="comment">//所以需要将ServletRequest对象强制转型才能调用</span></span><br><span class="line">       HttpServletRequest req = (HttpServletRequest)request;</span><br><span class="line">       <span class="comment">//获取请求行中的请求方式(GET/POST) </span></span><br><span class="line">       String method=req.getMethod();</span><br><span class="line">       <span class="comment">//获取请求行中的 URI</span></span><br><span class="line">       String uri = req.getRequestURI();</span><br><span class="line">       <span class="comment">//获取请求行中的HTTP版本</span></span><br><span class="line">       String http = req.getProtocol();</span><br><span class="line">       System.out.println(method+<span class="string">" "</span>+uri+<span class="string">" "</span>+http);</span><br><span class="line">       <span class="comment">//获取请求头中的信息</span></span><br><span class="line">       String host=req.getHeader(<span class="string">"Host"</span>);</span><br><span class="line">       String ua=req.getHeader(<span class="string">"User-Agent"</span>);</span><br><span class="line"></span><br><span class="line">       System.out.println(host);</span><br><span class="line">       System.out.println(ua);</span><br><span class="line">       <span class="comment">//获取全部的请求头信息:</span></span><br><span class="line">       <span class="comment">//Enumeration 与 Iterator 功能相同 </span></span><br><span class="line">       Enumeration&lt;String&gt; em=req.getHeaderNames();</span><br><span class="line">       <span class="comment">//em.hasMoreElements() 与 it.hasNext() 相同</span></span><br><span class="line">       <span class="comment">//em.nextElement();    与 it.next() 相同</span></span><br><span class="line">       <span class="keyword">while</span>(em.hasMoreElements()) &#123;</span><br><span class="line">           String name=em.nextElement();</span><br><span class="line">           System.out.println(name+<span class="string">":"</span>+req.getHeader(name));</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line">       response.setContentType(<span class="string">"text/html"</span>);</span><br><span class="line">       response.getWriter().println(<span class="string">"OK"</span>); </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig arg0)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>req<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day02.RequestDemoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>req<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/request-demo<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="HttpServletResponse"><a href="#HttpServletResponse" class="headerlink" title="HttpServletResponse"></a>HttpServletResponse</h3><p>HttpServletResponse 简称Response 其父类型是 ServletResponse</p>
<ol>
<li>Response用于处理服务器到客户端的响应, 其内部有一个缓冲, 用来保存响应信息.</li>
<li>ServletResponse 是父类型, 提供的方法没有 HttpServletResponse 多, 使用没有HttpServletResponse方便. 所以 HttpServletResponse 使用更多.</li>
<li>request提供的API用来处理向客户端发送的响应信息</li>
</ol>
<p>案例:</p>
<ol>
<li><p>编写Servlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseDemoServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//为了调用子类型的方法, 先进行类型转换</span></span><br><span class="line">        HttpServletRequest req=(HttpServletRequest)request;</span><br><span class="line">        HttpServletResponse res=(HttpServletResponse)response;</span><br><span class="line">        <span class="comment">//利用response对象, 处理对用户浏览器的响应</span></span><br><span class="line">        <span class="comment">//设置响应状态码, 默认状态码就是200</span></span><br><span class="line">        res.setStatus(<span class="number">200</span>); <span class="comment">//400 500 302 等</span></span><br><span class="line">        <span class="comment">//设置响应头, 设置UTF-8支持中文</span></span><br><span class="line">        res.setContentType(<span class="string">"text/html; charset=utf-8"</span>);</span><br><span class="line">        String str = <span class="string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;今天天气不错!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = str.getBytes(<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="comment">//设置消息正文长度</span></span><br><span class="line">        res.setContentLength(bytes.length); </span><br><span class="line">        <span class="comment">//添加一个自定义的响应头</span></span><br><span class="line">        res.setHeader(<span class="string">"msg"</span>, <span class="string">"Hello World!"</span>); </span><br><span class="line"></span><br><span class="line">        <span class="comment">//发送消息正文</span></span><br><span class="line">        res.getOutputStream().write(bytes); </span><br><span class="line">        <span class="comment">//将response中的信息刷出, 反馈到浏览器</span></span><br><span class="line">        <span class="comment">//如果不调用这个方法, Tomcat会自动调用!</span></span><br><span class="line">        res.flushBuffer();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig arg0)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>res<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day02.ResponseDemoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>res<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/response-demo<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试: 检查浏览器中收到的响应头信息, 是否包含自定义响应头<br>Response提供了更加简便的API, 可以替代如上的API:</p>
</li>
<li>采用默认的状态码200</li>
<li>先设置 Content-Type 头, 包含chaeset编码</li>
<li>在创建 PrintWriter对象, printWriter对象会自动处理文本的编码,并且会自动的设置Content-Length</li>
</ol>
<p>案例:</p>
<ol>
<li><p>编写Servlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseDemo2Servlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">        HttpServletResponse res = (HttpServletResponse) response;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1 响应状态码 200 时候可以不设置, 默认就是200</span></span><br><span class="line">        <span class="comment">//2 设置ContentType响应头, 通知浏览器正文内容和编码</span></span><br><span class="line">        res.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        <span class="comment">//3 获取 PrintWriter 对象, 字符流, 封装字符</span></span><br><span class="line">        <span class="comment">//  的编码功能. 按照ContentType设置编码utf-8</span></span><br><span class="line">        PrintWriter out = res.getWriter();</span><br><span class="line">        <span class="comment">//4 设置消息正文内容</span></span><br><span class="line">        out.print(<span class="string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;简单版本&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">        <span class="comment">//PrintWriter 会自动处理文字编码,设置ContentLength</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig arg0)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>res2<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day02.ResponseDemo2Servlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>res2<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/response2-demo<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="HttpServlet"><a href="#HttpServlet" class="headerlink" title="HttpServlet"></a>HttpServlet</h3><ul>
<li>实现Servlet接口创建Servlet非常繁琐, Servlet API 为了简化编程提供了更加简洁的API: HttpServlet.</li>
<li>HttpServlet实现了Servlet接口, 继承HttpServlet 就间接实现Servlet接口.</li>
<li>HttpServlet已经完整实现Servlet接口, 只需要简单重写 doGet或者doPost就可以方便的实现Servlet.</li>
<li>HttpServlet根据用户请求类型, 调用对应的doGet或者doPost方法.</li>
</ul>
<p>案例:</p>
<ol>
<li><p>创建Servlet类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpDemoServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req,HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        resp.setContentType(<span class="string">"text/html; charset=utf-8"</span>);</span><br><span class="line">        PrintWriter out=resp.getWriter();</span><br><span class="line">        out.print(<span class="string">"&lt;html&gt;&lt;body&gt;&lt;h1&gt;"</span>);</span><br><span class="line">        out.print(<span class="string">"第一个HttpServlet"</span>);</span><br><span class="line">        out.print(<span class="string">"&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>httpdemo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>day02.HttpDemoServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>httpdemo<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/http-demo<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>测试: 可以看出来 继承HttpServlet可以大大简化Servlet编码<br>利用Eclipse开发工具提供的Servlet向导可以快速创建Servlet, 这个功能了解即可.</p>
</li>
</ol>
<h2 id="概念梳理"><a href="#概念梳理" class="headerlink" title="概念梳理"></a>概念梳理</h2><p>URL/URI: 语法规则一致:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">协议://服务器/路径/资源名</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>URL 统一资源定位: 从你计算机开始能够唯一寻获的资源位置, 目标资源一定存在.<br><a href="http://cdn.tmooc.cn/bsfile//imgad///4E6DEFE23ED047B2B4AB7AD8B963E9B0.png" target="_blank" rel="noopener">http://cdn.tmooc.cn/bsfile//imgad///4E6DEFE23ED047B2B4AB7AD8B963E9B0.png</a></p>
</li>
<li><p>URI 统一资源识别: 是一个名字, 其对应的位置未必有资源. 目标资源不一定存在, 只是用来作为唯一标识名!!</p>
</li>
</ol>
<blockquote>
<p>请求行 GET /demo HTTP/1.1 URI</p>
</blockquote>
<p>Java WEB 目录结构</p>
<ol>
<li>Java EE 规定了web容器中的WEB应用目录结构<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">webapps    Tomcat WEB应用程序部署目录</span><br><span class="line">    |- examples     Webapp WEB应用</span><br><span class="line">    |   |- WEB-INF</span><br><span class="line">    |   |   |- lib</span><br><span class="line">    |   |   |   |- mysql-jdbc.jar  第三方的jar包</span><br><span class="line">    |   |   |- classes</span><br><span class="line">    |   |   |   |- xxx.class       编写的类文件</span><br><span class="line">    |   |   |- web.xml             部署描述文件</span><br><span class="line">    |   |- index.html</span><br><span class="line">wtpwebapps Eclipse创建了应用程序测试目录, 也是部署目录</span><br><span class="line">    |- Servlet02          Webapp WEB应用</span><br><span class="line">    |   |- WEB-INF</span><br><span class="line">    |   |   |- lib</span><br><span class="line">    |   |   |   |- mysql-jdbc.jar  第三方的jar包</span><br><span class="line">    |   |   |- classes</span><br><span class="line">    |   |   |   |- xxx.class       编写的类文件</span><br><span class="line">    |   |   |- web.xml             部署描述文件</span><br><span class="line">    |   |- index.html</span><br></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>WEB-INF 文件夹是用户不能直接看到的文件夹.</p>
<ol start="2">
<li>Eclipse 会自动在项目中创建目录结构, 在部署时候将目录结构复制到Tomcat中.</li>
</ol>
</blockquote>
<p>Maven 仓库检查步骤</p>
<ol>
<li>用浏览器检查是否能够看到仓库<ul>
<li>检查 <a href="https://mirrors.huaweicloud.com/repository/maven/" target="_blank" rel="noopener">https://mirrors.huaweicloud.com/repository/maven/</a></li>
<li>如果能够看到信息, 说明能够访问仓库, 相反说明网络故障.</li>
</ul>
</li>
<li><p>修改Eclipse中的Maven settings.xml 文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;mirror&gt;</span><br><span class="line">    &lt;id&gt;huaweicloud&lt;/id&gt;</span><br><span class="line">    &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</span><br><span class="line">    &lt;url&gt;https://mirrors.huaweicloud.com/repository/maven/&lt;/url&gt;</span><br><span class="line">&lt;/mirror&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启Eclipse 检查 Maven Repositories 是否连接到了Maven</p>
</li>
<li>在项目上执行 Maven -&gt; Update Project (Force Update)<ul>
<li>如果有必须的话, 可以先删除 .m2 文件夹再更新Maven</li>
</ul>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/26/Java-JDBC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Alone5">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wt Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/26/Java-JDBC/" itemprop="url">Java-JDBC</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-26T18:24:07+08:00">
                2019-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><ul>
<li>Java 数据库连接: 将Java程序连接到数据的桥梁.</li>
</ul>
<ol>
<li>Sun(Java) 设计了JDBC API底层封装了Socket, 简化数据库的访问.</li>
<li>JDBC为数据库提供了统一访问接口.</li>
</ol>
<ul>
<li>使用JDBC</li>
</ul>
<ol>
<li>利用maven导入数据库驱动<ul>
<li>创建Maven项目</li>
<li>找到 JDBC驱动程序的 坐标</li>
<li>将JDBC坐标添加到 pom.xml</li>
</ul>
</li>
<li>注册数据库驱动: 告诉JDBC如何找到数据库驱动的实现类<ul>
<li>最新的数据库驱动,会自动注册(有些驱动程序不支持).</li>
<li>建议手动注册:<ol>
<li>Class.forName(“数据库驱动程序类名”)</li>
<li>Class.forName(“com.mysql.jdbc.Driver”)</li>
</ol>
</li>
</ul>
</li>
<li><p>建立与数据库之间的连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String usr=<span class="string">"root"</span>;</span><br><span class="line">String pwd=<span class="string">""</span>;</span><br><span class="line"><span class="comment">//          jdbc:mysql://数据库IP:3306/数据库名    </span></span><br><span class="line">String url=<span class="string">"jdbc:mysql://localhost:3306/db6"</span>;</span><br><span class="line">Connection conn=DriverManger.getConnection(url, usr, pwd);</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建Statement(语句)对象: 用于执行SQL(操作数据库)</p>
<ol>
<li>DDL create drop 等 一般使用 execute</li>
<li>DML insert delete update 一般使用 executeUpdate 执行</li>
<li>DQL select 一般使用 executeQuery<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String sql = <span class="string">"create table t_user(id int, name varchar(50))"</span>;</span><br><span class="line">Statement st = conn.createStatement();</span><br><span class="line">st.execute(sql);</span><br><span class="line">st.close();</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>关闭连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conn.close();</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>建表案例:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    <span class="comment">//注册数据库驱动</span></span><br><span class="line">    Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">    <span class="comment">//建立连接</span></span><br><span class="line">    String usr=<span class="string">"root"</span>;</span><br><span class="line">    String pwd=<span class="string">"root"</span>;</span><br><span class="line">    String url=<span class="string">"jdbc:mysql://localhost:3306/db6"</span>;</span><br><span class="line">    Connection conn = </span><br><span class="line">            DriverManager.getConnection(url,usr,pwd);</span><br><span class="line">    <span class="comment">//测试:</span></span><br><span class="line">    System.out.println(conn);  </span><br><span class="line">    <span class="comment">//创建Statement对象,执行SQL</span></span><br><span class="line">    Statement st = conn.createStatement();</span><br><span class="line">    String sql = <span class="string">"create table t_user ("</span></span><br><span class="line">            + <span class="string">"id int, "</span></span><br><span class="line">            + <span class="string">"name varchar(100))"</span>;</span><br><span class="line">    <span class="comment">//执行sql语句</span></span><br><span class="line">    st.execute(sql);</span><br><span class="line">    st.close();</span><br><span class="line">    <span class="comment">//关闭连接</span></span><br><span class="line">    conn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>插入数据案例:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用JDBC执行插入语句</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String sql=<span class="string">"insert into t_user "</span></span><br><span class="line">            + <span class="string">"(id, name) "</span></span><br><span class="line">            + <span class="string">"values (2, '范传奇')"</span>; </span><br><span class="line">    <span class="comment">//注册驱动</span></span><br><span class="line">    Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//连接数据库</span></span><br><span class="line">    String url=<span class="string">"jdbc:mysql://localhost:3306/db6?characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false"</span>;</span><br><span class="line">    String username=<span class="string">"root"</span>;</span><br><span class="line">    String password=<span class="string">"root"</span>;</span><br><span class="line">    Connection conn = DriverManager.getConnection(</span><br><span class="line">        url, username, password);</span><br><span class="line">    <span class="comment">//创建 Statement对象</span></span><br><span class="line">    Statement st = conn.createStatement();</span><br><span class="line">    <span class="comment">//executeUpdate 返回数据库中更新行数!</span></span><br><span class="line">    <span class="keyword">int</span> n = st.executeUpdate(sql);</span><br><span class="line">    <span class="comment">//处理SQL结果</span></span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">"插入成功!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭资源和连接</span></span><br><span class="line">    st.close();</span><br><span class="line">    conn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MySQL JDBC 连接常用参数, 写在连接url上:</p>
</li>
</ul>
<ol>
<li><p>characterEncoding 字符编码, 可以设置为utf8</p>
</li>
<li><p>useUnicode 是否使用unicode字符编码, 设置为true</p>
</li>
<li><p>关闭ssl加密, useSSL 设置为false</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql:<span class="comment">//localhost:3306/db6?						characterEncoding=utf8&amp;useUnicode=true&amp;useSSL=false</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>删除案例  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用JDBC执行删除语句</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String sql=<span class="string">"delete from t_user where id=1"</span>;  </span><br><span class="line">    <span class="comment">//注册驱动</span></span><br><span class="line">    Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">    <span class="comment">//连接数据库</span></span><br><span class="line">    String url=<span class="string">"jdbc:mysql://localhost:3306/db6"</span>;</span><br><span class="line">    String username=<span class="string">"root"</span>;</span><br><span class="line">    String password=<span class="string">"root"</span>;</span><br><span class="line">    Connection conn = DriverManager.getConnection(</span><br><span class="line">        url, username, password);</span><br><span class="line">    <span class="comment">//创建 Statement对象</span></span><br><span class="line">    Statement st = conn.createStatement();</span><br><span class="line">    <span class="comment">//executeUpdate 返回数据库中更新行数!</span></span><br><span class="line">    <span class="keyword">int</span> n = st.executeUpdate(sql);</span><br><span class="line">    <span class="comment">//处理SQL结果</span></span><br><span class="line">    <span class="keyword">if</span>(n&gt;=<span class="number">1</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">"删除成功!"</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"删除失败!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//关闭资源和连接</span></span><br><span class="line">    st.close();</span><br><span class="line">    conn.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Alone5</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">70</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alone5</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
